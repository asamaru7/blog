<!doctype html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
	<title>안드로이드 세로 중앙정렬 Span(VerticalCenterSpan)</title>
	<meta name="author" content="유영재">
	<meta name="keywords" content="android,tip,vagrant,js,osx,php,linux,html,flash,jekyll,git,db,java,thinking,octopress,swift,ios,blog,css,programming">
	<meta name="description" content="SpannableString을 사용하던 중에 사이즈가 다른 두 단어를 세로로 중앙 정렬해야 할 일이 생겼다. 그런데 찾아보니 그런 Span은 없고 비슷한 기능이 있는 것들도 BASELINE 또는 BOTTOM으로만 정렬이 가능했다. 그래서 간단하게 Span 클래스를 하나 만들었다. 단, 주의할 것은 multi line은 지원하지 않는다는 것이다(내가 당장 필요하지 않아서 기능을 구현하지 않았다). VerticalCenterSpan.java import android.graphics.Canvas; import android.graphi">
	<meta name="referrer" content="always">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="shortcut icon" type="image/x-icon" href="https://blog.asamaru.net/favicon.ico"/>
	<link rel="canonical" href="https://blog.asamaru.net/2015/10/16/android-verticalcenterspan/"/>

	
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">

	
	
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="이 세상에 하나는 남기고 가자">
	<meta property="og:title" content="안드로이드 세로 중앙정렬 Span(VerticalCenterSpan)">
	<meta property="og:description" content="SpannableString을 사용하던 중에 사이즈가 다른 두 단어를 세로로 중앙 정렬해야 할 일이 생겼다. 그런데 찾아보니 그런 Span은 없고 비슷한 기능이 있는 것들도 BASELINE 또는 BOTTOM으로만 정렬이 가능했다. 그래서 간단하게 Span 클래스를 하나 만들었다. 단, 주의할 것은 multi line은 지원하지 않는다는 것이다(내가 당장 필요하지 않아서 기능을 구현하지 않았다). VerticalCenterSpan.java import android.graphics.Canvas; import android.graphi">
	<meta property="og:image" content="https://blog.asamaru.net/res/img/icon/icon.png">
	

	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@asamaru7">
	<meta name="twitter:title" content="안드로이드 세로 중앙정렬 Span(VerticalCenterSpan)">
	<meta name="twitter:description" content="SpannableString을 사용하던 중에 사이즈가 다른 두 단어를 세로로 중앙 정렬해야 할 일이 생겼다. 그런데 찾아보니 그런 Span은 없고 비슷한 기능이 있는 것들도 BASELINE 또는 BOTTOM으로만 정렬이 가능했다. 그래서 간단하게 Span 클래스를 하나 만들었다. 단, 주의할 것은 multi line은 지원하지 않는다는 것이다(내가 당장 필요하지 않아서 기능을 구현하지 않았다). VerticalCenterSpan.java import android.graphics.Canvas; import android.graphi">
	<meta property="twitter:image" content="https://blog.asamaru.net/res/img/icon/icon.png">
	

										<link rel="apple-touch-icon" sizes="180x180" href="/res/img/icon/180.png">
												<link rel="apple-touch-icon" sizes="76x76" href="/res/img/icon/76.png">
												<link rel="apple-touch-icon" sizes="120x120" href="/res/img/icon/120.png">
												<link rel="apple-touch-icon" sizes="152x152" href="/res/img/icon/152.png">
						
	<link rel="alternate" type="application/rss+xml" title="이 세상에 하나는 남기고 가자" href="https://blog.asamaru.net/atom.xml"/>

			<link href="/res/css/min/80795a7fa0bcc071bdfad3cba7050da9.css" type="text/css" rel="stylesheet" />

	 <script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "안드로이드 세로 중앙정렬 Span(VerticalCenterSpan)",
    "author": {
        "@type": "Person",
        "name": "유영재"
    },
    "datePublished": "2015-10-16",
    "articleSection": "android",
    "url": "https://blog.asamaru.net/2015/10/16/android-verticalcenterspan/",
    "image": "",
    "publisher": {
        "@type": "Organization",
        "name": "유영재"
    }
}</script> 
			<script type="text/javascript">
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
					(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-65749108-2', 'auto');
			ga('send', 'pageview');
		</script>
	</head>
<body>
<header>
	<div class="dProfile">
		<a href="https://blog.asamaru.net"><img src="https://blog.asamaru.net/res/img/icon/icon.png" width="50" height="50" alt="profile"></a>
		<h1><a href="https://blog.asamaru.net">이 세상에 하나는 남기고 가자</a></h1>
					<p>세상에 필요한 소스코드 한줄 남기고 가자</p>
			</div>
</header>
<section class="dMainBody">
<nav id="cSide">
	<div class="dSideBox">
										
										<dl class="dTags">
					<dt>태그</dt>
											<dd>
							<a href="https://blog.asamaru.net/category/android/">
								android<span>(56)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/blog/">
								blog<span>(1)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/css/">
								css<span>(3)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/db/">
								db<span>(6)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/flash/">
								flash<span>(1)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/git/">
								git<span>(7)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/html/">
								html<span>(2)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/ios/">
								ios<span>(20)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/java/">
								java<span>(5)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/jekyll/">
								jekyll<span>(2)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/js/">
								js<span>(11)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/linux/">
								linux<span>(27)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/octopress/">
								octopress<span>(8)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/osx/">
								osx<span>(8)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/php/">
								php<span>(25)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/programming/">
								programming<span>(1)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/swift/">
								swift<span>(6)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/thinking/">
								thinking<span>(3)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/tip/">
								tip<span>(15)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/vagrant/">
								vagrant<span>(6)</span>
							</a>
						</dd>
									</dl>
			
			
										<dl class="dArchives">
					<dt>글 보관함</dt>
											<dd class="dYear"><a href="https://blog.asamaru.net/2016/">2016 <span>(65)</span></a></dd>
													<dd>
								<dl>
									
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/12/">12 <span>(5)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/11/">11 <span>(11)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/10/">10 <span>(2)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/09/">09 <span>(2)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/08/">08 <span>(2)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/07/">07 <span>(5)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/05/">05 <span>(1)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/04/">04 <span>(9)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/03/">03 <span>(13)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/02/">02 <span>(7)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/01/">01 <span>(8)</span></a>
										</dd>
																	</dl>
							</dd>
																	<dd class="dYear"><a href="https://blog.asamaru.net/2015/">2015 <span>(118)</span></a></dd>
													<dd>
								<dl>
									
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/12/">12 <span>(16)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/11/">11 <span>(16)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/10/">10 <span>(41)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/09/">09 <span>(37)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/08/">08 <span>(8)</span></a>
										</dd>
																	</dl>
							</dd>
																	<dd class="dYear"><a href="https://blog.asamaru.net/2012/">2012 <span>(7)</span></a></dd>
													<dd>
								<dl>
									
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2012/10/">10 <span>(1)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2012/09/">09 <span>(6)</span></a>
										</dd>
																	</dl>
							</dd>
															</dl>
					
				
		
		<form action="https://www.google.com/search" method="get" class="dFormSearch">
			<fieldset>
				<input type="hidden" name="sitesearch" value="https://blog.asamaru.net">
				<legend>검색하기 폼</legend>
				<label class="dIcon">검색하기</label>
				<input type="text" name="q" value="" placeholder="Search"/>
			</fieldset>
		</form>

		
		<ul class="dLinks">
			<li><a href="https://blog.asamaru.net/archives/" class="dInverse">전체글 보기</a></li>
			<li class="dPipe"></li>
			<li><a href="https://blog.asamaru.net/atom.xml" class="dInverse" target="_blank">RSS</a></li>
		</ul>
	</div>
</nav>



















<main id="cMainPanel" class="clearfix">
		
	<article id="cArticle" class="dArticle hentry">
		<div class="dTitle">
			<h2 class="entry-title">안드로이드 세로 중앙정렬 Span(VerticalCenterSpan)</h2>
												<a href="https://blog.asamaru.net/category/android/" rel="tag">android</a>
								<span></span>
						<time class="published" datetime="2015-10-16 13:37:07">2015.10.16. 13:37</time>
		</div>
		<div class="markdown-body entry-content"><p>SpannableString을 사용하던 중에 사이즈가 다른 두 단어를 세로로 중앙 정렬해야 할 일이 생겼다. 그런데 찾아보니 그런 Span은 없고 비슷한 기능이 있는 것들도 BASELINE 또는 BOTTOM으로만 정렬이 가능했다. 그래서 간단하게 Span 클래스를 하나 만들었다. 단, 주의할 것은 multi line은 지원하지 않는다는 것이다(내가 당장 필요하지 않아서 기능을 구현하지 않았다).</p>
<p><strong>VerticalCenterSpan.java</strong></p>
<pre class="hljs java"><span class="hljs-keyword">import</span> android.graphics.Canvas;
<span class="hljs-keyword">import</span> android.graphics.Paint;
<span class="hljs-keyword">import</span> android.text.style.ReplacementSpan;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VerticalCenterSpan</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ReplacementSpan</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">VerticalCenterSpan</span><span class="hljs-params">()</span> </span>{
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">(Canvas canvas, CharSequence text, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end, <span class="hljs-keyword">float</span> x, <span class="hljs-keyword">int</span> top, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> bottom, Paint paint)</span> </span>{
        <span class="hljs-keyword">int</span> yPos = (<span class="hljs-keyword">int</span>) ((canvas.getHeight() / <span class="hljs-number">2</span>) - ((paint.descent() + paint.ascent()) / <span class="hljs-number">2</span>));
        canvas.drawText(text, start, end, x, yPos, paint);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">(Paint paint, CharSequence text, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end, Paint.FontMetricsInt fm)</span> </span>{
        <span class="hljs-keyword">return</span> Math.round(paint.measureText(text, start, end));
    }
}
</pre>
<p>그런데 사용시에 유의할 점이 있다. 다른 Span과 함께 적용시에 일부는 적용되지 않을 수 있다는 것이다. 예를 들어 아래의 예를 보자(아래 소스는 이해를 위해 부분만 넣어둔 것이다).</p>
<pre class="hljs java">styledText.setSpan(<span class="hljs-keyword">new</span> AbsoluteSizeSpan(<span class="hljs-number">12</span>, <span class="hljs-keyword">true</span>), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
styledText.setSpan(<span class="hljs-keyword">new</span> ForegroundColorSpan(ContextCompat.getColor(<span class="hljs-keyword">this</span>, R.color.newColor)), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
styledText.setSpan(<span class="hljs-keyword">new</span> VerticalCenterSpan(), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</pre>
<p>위 소스는 글자 크기와 색상을 바꾼 후 세로 중앙정렬을 하기 위한 코드다. 그런데 실행해보면 색상이 적용되지 않는다. 이 것과 관련해서는 정확한 이유를 확인해보지는 못했지만 <a href="http://stackoverflow.com/a/28329166">ForegroundColorSpan is not applied to ReplacementSpan</a>를 보면 버그라고 추정하는 것 같다. 어쨌든 색상도 함께 바꾸어야 할 경우를 위해 조금 변경한 소스는 아래와 같다.</p>
<p><strong>ColorVerticalCenterSpan.java</strong></p>
<pre class="hljs java"><span class="hljs-keyword">import</span> android.graphics.Canvas;
<span class="hljs-keyword">import</span> android.graphics.Paint;
<span class="hljs-keyword">import</span> android.graphics.RectF;
<span class="hljs-keyword">import</span> android.text.style.ReplacementSpan;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ColorVerticalCenterSpan</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ReplacementSpan</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> backgroundColor = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> foregroundColor = <span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ColorVerticalCenterSpan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> foregroundColor)</span> </span>{
        <span class="hljs-keyword">this</span>.foregroundColor = foregroundColor;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ColorVerticalCenterSpan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> foregroundColor, <span class="hljs-keyword">int</span> backgroundColor)</span> </span>{
        <span class="hljs-keyword">this</span>.backgroundColor = backgroundColor;
        <span class="hljs-keyword">this</span>.foregroundColor = foregroundColor;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">(Canvas canvas, CharSequence text, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end, <span class="hljs-keyword">float</span> x, <span class="hljs-keyword">int</span> top, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> bottom, Paint paint)</span> </span>{
        <span class="hljs-comment">// Background</span>
        <span class="hljs-keyword">if</span> (backgroundColor != <span class="hljs-number">0</span>) {
            paint.setColor(backgroundColor);
            canvas.drawRect(<span class="hljs-keyword">new</span> RectF(x, top, x + paint.measureText(text, start, end), bottom), paint);
        }

        <span class="hljs-comment">// Text</span>
        <span class="hljs-keyword">if</span> (foregroundColor != <span class="hljs-number">0</span>) {
            paint.setColor(foregroundColor);
        }
        <span class="hljs-keyword">int</span> yPos = (<span class="hljs-keyword">int</span>) ((canvas.getHeight() / <span class="hljs-number">2</span>) - ((paint.descent() + paint.ascent()) / <span class="hljs-number">2</span>));
        canvas.drawText(text, start, end, x, yPos, paint);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">(Paint paint, CharSequence text, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end, Paint.FontMetricsInt fm)</span> </span>{
        <span class="hljs-keyword">return</span> Math.round(paint.measureText(text, start, end));
    }
}</pre>
<p>이 코드를 이용해서 아래와 같이 사용하면 원하는 결과를 얻을 수 있다.</p>
<pre class="hljs java">styledText.setSpan(<span class="hljs-keyword">new</span> AbsoluteSizeSpan(<span class="hljs-number">12</span>, <span class="hljs-keyword">true</span>), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
styledText.setSpan(<span class="hljs-keyword">new</span> ColorVerticalCenterSpan(ContextCompat.getColor(<span class="hljs-keyword">this</span>, R.color.newColor)), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</pre>
<p>아니면 위에 링크한 StackOverflow의 답변처럼 FontColorSpan 클래스를 추가해서 사용하는 방법도 가능하다. 예를들면 아래처럼.</p>
<pre class="hljs java">styledText.setSpan(<span class="hljs-keyword">new</span> AbsoluteSizeSpan(<span class="hljs-number">12</span>, <span class="hljs-keyword">true</span>), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
styledText.setSpan(<span class="hljs-keyword">new</span> FontColorSpan(ContextCompat.getColor(<span class="hljs-keyword">this</span>, R.color.newColor)), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
styledText.setSpan(<span class="hljs-keyword">new</span> VerticalCenterSpan(), <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</pre>
</div>
	</article>
			<div id="disqus_thread"></div>
	<script type="text/javascript">
		var disqus_shortname = 'asamaru7'; // required: replace example with your forum shortname
		// var disqus_developer = 1; // Comment out when the site is live
		var disqus_identifier = "https://blog.asamaru.net/2015/10/16/android-verticalcenterspan/";

		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function () {
			var dsq = document.createElement('script');
			dsq.type = 'text/javascript';
			dsq.async = true;
			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</main>

</section>
<footer>
	hosted by <a href="https://github.com/"><em>Github</em></a> / Posted by <a href="mailto:asamaru@asamaru.net"><em>유영재</em></a>
</footer>
<script src="/res/js/min/8de8e7a5c62f66f29ca7c27dad5246b9.js" type="text/javascript"></script>
<button type="button" id="cBtnSlide"></button>
<script>
	(function () {
		function addEvent(element, evnt, funct) {
			if (element.attachEvent)
				return element.attachEvent('on' + evnt, funct);
			else
				return element.addEventListener(evnt, funct, false);
		}

		var slideout = new Slideout({
			'panel': document.getElementById('cMainPanel'),
			'menu': document.getElementById('cSide'),
			'padding': 300,
			'tolerance': 70,
			'side': 'right'
		});
		addEvent(
			document.getElementById('cBtnSlide'),
			'click',
			function () {
				slideout.toggle();
			}
		);
	})();
</script>

</body>
</html>