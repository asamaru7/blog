<!doctype html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
			<title>MFMailComposeViewController without &#039;No Mail Accounts&#039; messages - 이 세상에 하나는 남기고 가자</title>
		<meta name="author" content="유영재">
	<meta name="keywords" content="android,blog,css,db,flash,git,html,ios,java,jekyll,js,linux,octopress,osx,php,programming,swift,thinking,tip,vagrant">
	<meta name="description" content="iOS 개발시 앱 내에서 메일 발송폼을 보여주고자 할 때 사용하게 되는 것이 MFMailComposeViewController 이다. 이 클래스를 swift에서 사용할 경우 대부분 아래와 같이 사용하게 된다. let mc = MFMailComposeViewController() mc.mailComposeDelegate = self mc.setToRecipients([to]) if (subject != nil) { mc.setSubject(subject!) } if (body != nil) { mc.setMessageBody(body">
	<meta name="referrer" content="always">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="shortcut icon" type="image/x-icon" href="https://blog.asamaru.net/favicon.ico"/>
	<link rel="canonical" href="https://blog.asamaru.net/2015/10/20/mfmailcomposeviewcontroller-without-no-mail-accounts-messages/"/>
			<link rel="amphtml" href="https://blog.asamaru.net/amp/2015/10/20/mfmailcomposeviewcontroller-without-no-mail-accounts-messages/">
	
	
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">

	
	
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="이 세상에 하나는 남기고 가자">
	<meta property="og:title" content="MFMailComposeViewController without &#039;No Mail Accounts&#039; messages">
	<meta property="og:description" content="iOS 개발시 앱 내에서 메일 발송폼을 보여주고자 할 때 사용하게 되는 것이 MFMailComposeViewController 이다. 이 클래스를 swift에서 사용할 경우 대부분 아래와 같이 사용하게 된다. let mc = MFMailComposeViewController() mc.mailComposeDelegate = self mc.setToRecipients([to]) if (subject != nil) { mc.setSubject(subject!) } if (body != nil) { mc.setMessageBody(body">
	<meta property="og:image" content="/res/img/icon/icon.png">
	

	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@asamaru7">
	<meta name="twitter:title" content="MFMailComposeViewController without &#039;No Mail Accounts&#039; messages">
	<meta name="twitter:description" content="iOS 개발시 앱 내에서 메일 발송폼을 보여주고자 할 때 사용하게 되는 것이 MFMailComposeViewController 이다. 이 클래스를 swift에서 사용할 경우 대부분 아래와 같이 사용하게 된다. let mc = MFMailComposeViewController() mc.mailComposeDelegate = self mc.setToRecipients([to]) if (subject != nil) { mc.setSubject(subject!) } if (body != nil) { mc.setMessageBody(body">
	<meta property="twitter:image" content="/res/img/icon/icon.png">
	

										<link rel="apple-touch-icon" sizes="180x180" href="/res/img/icon/180.png">
												<link rel="apple-touch-icon" sizes="76x76" href="/res/img/icon/76.png">
												<link rel="apple-touch-icon" sizes="120x120" href="/res/img/icon/120.png">
												<link rel="apple-touch-icon" sizes="152x152" href="/res/img/icon/152.png">
						
	<link rel="alternate" type="application/rss+xml" title="이 세상에 하나는 남기고 가자" href="https://blog.asamaru.net/atom.xml"/>

			<link href="/res/css/min/x94f5e63f5987c8618ada4116836f00ef7f641da4.css" type="text/css" rel="stylesheet" />

	 <script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "MFMailComposeViewController without 'No Mail Accounts' messages",
    "author": {
        "@type": "Person",
        "name": "유영재"
    },
    "datePublished": "2015-10-20",
    "dateModified": "2015-10-20",
    "articleSection": "ios",
    "url": "https://blog.asamaru.net/2015/10/20/mfmailcomposeviewcontroller-without-no-mail-accounts-messages/",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.asamaru.net/res/img/icon/icon.696.png",
        "width": 696,
        "height": 696
    },
    "publisher": {
        "@type": "Organization",
        "name": "유영재",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.asamaru.net/res/img/icon/icon.60.png",
            "width": 60,
            "height": 60
        }
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.asamaru.net/2015/10/20/mfmailcomposeviewcontroller-without-no-mail-accounts-messages/"
    }
}</script> 
			<script type="text/javascript">
			(function (i, s, o, g, r, a, m) {
				i['GoogleAnalyticsObject'] = r;
				i[r] = i[r] || function () {
						(i[r].q = i[r].q || []).push(arguments)
					}, i[r].l = 1 * new Date();
				a = s.createElement(o),
					m = s.getElementsByTagName(o)[0];
				a.async = 1;
				a.src = g;
				m.parentNode.insertBefore(a, m)
			})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

			ga('create', 'UA-65749108-2', 'auto');
			ga('send', 'pageview');
		</script>
	</head>
<body>
<header>
	<div class="dProfile">
		<a href="https://blog.asamaru.net"><img src="/res/img/icon/icon.png" width="50" height="50" alt="profile"></a>
		<h1><a href="https://blog.asamaru.net">이 세상에 하나는 남기고 가자</a></h1>
					<p>세상에 필요한 소스코드 한줄 남기고 가자</p>
				<button type="button" id="cBtnSlide"></button>
	</div>
</header>
<section class="dMainBody">
<div class="dWrapContent">
	<main id="cMainPanel" class="clearfix">
			
	<article id="cArticle" class="dArticle hentry">
		<div class="dTitle">
			<h2 class="entry-title">MFMailComposeViewController without &#039;No Mail Accounts&#039; messages</h2>
												<a href="https://blog.asamaru.net/category/ios/" rel="tag">ios</a>
								<span></span>
						<time class="published" datetime="2015-10-20 09:47:16">2015.10.20. 09:47</time>
		</div>
		<div class="markdown-body entry-content"><p>iOS 개발시 앱 내에서 메일 발송폼을 보여주고자 할 때 사용하게 되는 것이 <a href="https://developer.apple.com/library/prerelease/ios/documentation/MessageUI/Reference/MFMailComposeViewController_class/index.html">MFMailComposeViewController</a> 이다. 이 클래스를 swift에서 사용할 경우 대부분 아래와 같이 사용하게 된다.</p>
<pre class="hljs swift"><span class="hljs-keyword">let</span> mc = <span class="hljs-type">MFMailComposeViewController</span>()
mc.mailComposeDelegate = <span class="hljs-keyword">self</span>
mc.setToRecipients([to])
<span class="hljs-keyword">if</span> (subject != <span class="hljs-literal">nil</span>) {
    mc.setSubject(subject!)
}
<span class="hljs-keyword">if</span> (body != <span class="hljs-literal">nil</span>) {
    mc.setMessageBody(body!, isHTML: <span class="hljs-literal">false</span>)
}
<span class="hljs-keyword">if</span> <span class="hljs-type">MFMailComposeViewController</span>.canSendMail() {
    getRootViewController()?.presentViewController(mc, animated: <span class="hljs-literal">true</span>, completion: <span class="hljs-literal">nil</span>)
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">let</span> alertView = <span class="hljs-type">UIAlertController</span>(title: <span class="hljs-string">"안내"</span>, message: <span class="hljs-string">"현재 디바이스에서 이메일을 보낼수가 없습니다. 설정에서 이메일 관련 설정을 확인해주세요."</span>, preferredStyle: .<span class="hljs-type">Alert</span>)
    alertView.addAction(<span class="hljs-type">UIAlertAction</span>(title: <span class="hljs-string">"Ok"</span>, style: .<span class="hljs-type">Default</span>, handler: <span class="hljs-literal">nil</span>))
    presentViewController(alertView, animated: <span class="hljs-literal">true</span>, completion: <span class="hljs-literal">nil</span>)
}</pre>
<p>그런데 위 코드처럼 사용하게 되면 설정된 메일 계정이 없어 메일 발송이 불가능할 경우 'No Mail Accounts' 메시지가 먼저 나오게 된다(쉽게 말해서 메시지가 두개가 뜬다). 그렇다면 'No Mail Accounts' 메시지는 나오지 않게 하고 내가 지정한 메시지가 나오게 하려면 어떻게 해야할까?</p>
<pre class="hljs swift"><span class="hljs-keyword">if</span> <span class="hljs-type">MFMailComposeViewController</span>.canSendMail() {
    <span class="hljs-keyword">let</span> mc = <span class="hljs-type">MFMailComposeViewController</span>()
    mc.mailComposeDelegate = <span class="hljs-keyword">self</span>
    mc.setToRecipients([to])
    <span class="hljs-keyword">if</span> (subject != <span class="hljs-literal">nil</span>) {
        mc.setSubject(subject!)
    }
    <span class="hljs-keyword">if</span> (body != <span class="hljs-literal">nil</span>) {
        mc.setMessageBody(body!, isHTML: <span class="hljs-literal">false</span>)
    }
    getRootViewController()?.presentViewController(mc, animated: <span class="hljs-literal">true</span>, completion: <span class="hljs-literal">nil</span>)
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">let</span> alertView = <span class="hljs-type">UIAlertController</span>(title: <span class="hljs-string">"안내"</span>, message: <span class="hljs-string">"현재 디바이스에서 이메일을 보낼수가 없습니다. 설정에서 이메일 관련 설정을 확인해주세요."</span>, preferredStyle: .<span class="hljs-type">Alert</span>)
    alertView.addAction(<span class="hljs-type">UIAlertAction</span>(title: <span class="hljs-string">"Ok"</span>, style: .<span class="hljs-type">Default</span>, handler: <span class="hljs-literal">nil</span>))
    presentViewController(alertView, animated: <span class="hljs-literal">true</span>, completion: <span class="hljs-literal">nil</span>)
}</pre>
<p>위 코드처럼 <code>MFMailComposeViewController.canSendMail()</code> 호출 이후에 <code>MFMailComposeViewController()</code>를 생성하면 'No Mail Accounts' 메시지는 나오지 않고 내가 지정한 메시지가 나타나게된다. 정확한 이유는 확인하지 못했지만 어쨌든 이렇게 하면 된다.</p>
<hr />
<p>그리고 MFMailComposeViewController 이야기가 나온 김에 한가지 문제를 더 알아보자.</p>
<p>MFMailComposeViewController를 사용해서 시뮬레이터에서 실행해보면 이상하게도 아래의 오류가 날 수 있다.</p>
<pre><code>viewServiceDidTerminateWithError: Error Domain=_UIViewServiceInterfaceErrorDomain Code=3 "(null)" UserInfo={Message=Service Connection Interrupted}</code></pre>
<p>우선 <a href="http://stackoverflow.com/questions/25604552/i-have-real-misunderstanding-with-mfmailcomposeviewcontroller-in-swift-ios8-in/25864182#25864182">I have REAL misunderstanding with MFMailComposeViewController in Swift (iOS8) in Simulator</a>를 살펴보자. 이 문제에 대한 설명이 되어 있다.
여기서는 Obj-C로 설명되어 있긴하지만 swift로 내용을 변경하는 것은 어렵지 않을 것이다. 그런데 문제는 나의 이렇게 해도 해결이 되지 않는다는 것이다. 사실 위 글을 잘 읽어보면 MFMailComposeViewController을 재사용할 경우에 대한 문제로 시뮬레이터에서 발생하는 문제와는 상관이 없다. 그래서 여러곳을 찾아보니 시뮬레이터만 문제가되고 실 기기에서는 해당 오류가 나지 않는다는 이야기들이 있다. 그리고 iOS 8.3에서 해결되었다는 등의 이야기도 있다. 그런데 나는 iOS 9 기준으로 테스트를 해봤지만 해결되지 않았다. <a href="https://forums.developer.apple.com/thread/4415">MailCompositionService quit unexpectedly</a>를 보면 아직도 해결되지 않은 것으로 보인다. 하지만 기기에서만 문제되지 않는다면 나도 일단은 상관없다고 생각한다.</p>
</div>
	</article>

	<section class="dShare">
	
			<amp-social-share type="facebook" data-param-app_id="1796234843959223" width="60" height="44"></amp-social-share>
		<amp-social-share type="twitter" width="60" height="44"></amp-social-share>
	<amp-social-share type="gplus" width="60" height="44"></amp-social-share>
	<amp-social-share type="pinterest" width="60" height="44"></amp-social-share>
	<amp-social-share type="linkedin" width="60" height="44"></amp-social-share>
	<amp-social-share type="email" width="60" height="44"></amp-social-share>
</section>

			<div id="disqus_thread"></div>
	<script type="text/javascript">
		var disqus_shortname = 'asamaru7'; // required: replace example with your forum shortname
		// var disqus_developer = 1; // Comment out when the site is live
		var disqus_identifier = "/2015/10/20/mfmailcomposeviewcontroller-without-no-mail-accounts-messages/";

		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function () {
			var dsq = document.createElement('script');
			dsq.type = 'text/javascript';
			dsq.async = true;
			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</main>
</div>
<nav id="cSide">
	<div class="dSideBox">
										
										<dl class="dTags">
					<dt>태그</dt>
											<dd>
							<a href="https://blog.asamaru.net/category/android/">
								android<span>(56)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/blog/">
								blog<span>(1)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/css/">
								css<span>(3)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/db/">
								db<span>(6)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/flash/">
								flash<span>(1)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/git/">
								git<span>(7)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/html/">
								html<span>(2)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/ios/">
								ios<span>(21)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/java/">
								java<span>(5)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/jekyll/">
								jekyll<span>(2)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/js/">
								js<span>(11)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/linux/">
								linux<span>(27)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/octopress/">
								octopress<span>(8)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/osx/">
								osx<span>(9)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/php/">
								php<span>(25)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/programming/">
								programming<span>(1)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/swift/">
								swift<span>(6)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/thinking/">
								thinking<span>(5)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/tip/">
								tip<span>(15)</span>
							</a>
						</dd>
											<dd>
							<a href="https://blog.asamaru.net/category/vagrant/">
								vagrant<span>(6)</span>
							</a>
						</dd>
									</dl>
			
			
										<dl class="dArchives">
					<dt>글 보관함</dt>
											<dd class="dYear"><a href="https://blog.asamaru.net/2016/">2016 <span>(68)</span></a></dd>
													<dd>
								<dl>
									
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/12/">12 <span>(8)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/11/">11 <span>(11)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/10/">10 <span>(2)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/09/">09 <span>(2)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/08/">08 <span>(2)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/07/">07 <span>(5)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/05/">05 <span>(1)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/04/">04 <span>(9)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/03/">03 <span>(13)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/02/">02 <span>(7)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2016/01/">01 <span>(8)</span></a>
										</dd>
																	</dl>
							</dd>
																	<dd class="dYear"><a href="https://blog.asamaru.net/2015/">2015 <span>(118)</span></a></dd>
													<dd>
								<dl>
									
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/12/">12 <span>(16)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/11/">11 <span>(16)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/10/">10 <span>(41)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/09/">09 <span>(37)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2015/08/">08 <span>(8)</span></a>
										</dd>
																	</dl>
							</dd>
																	<dd class="dYear"><a href="https://blog.asamaru.net/2012/">2012 <span>(7)</span></a></dd>
													<dd>
								<dl>
									
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2012/10/">10 <span>(1)</span></a>
										</dd>
																			<dd class="dMonth">
											<a href="https://blog.asamaru.net/2012/09/">09 <span>(6)</span></a>
										</dd>
																	</dl>
							</dd>
															</dl>
					
				
		
		<form action="https://www.google.com/search" method="get" target="_blank" class="dFormSearch">
			<fieldset>
				<input type="hidden" name="sitesearch" value="https://blog.asamaru.net">
				<legend>검색하기 폼</legend>
				<label class="dIcon">검색하기</label>
				<input type="text" name="q" value="" placeholder="Search"/>
			</fieldset>
		</form>

		
		<ul class="dLinks">
			<li><a href="https://blog.asamaru.net/archives/" class="dInverse">전체글 보기</a></li>
			<li class="dPipe"></li>
			<li><a href="https://blog.asamaru.net/atom.xml" class="dInverse" target="_blank">RSS</a></li>
		</ul>
	</div>
</nav>



















</section>
<footer>
	hosted by <a href="https://github.com/"><em>Github</em></a> / Posted by <a href="mailto:asamaru@asamaru.net"><em>유영재</em></a>
</footer>
<script src="/res/js/min/x25c84402d894075554f1198a50334a11367f0ad8.js" type="text/javascript"></script>
<script>
	(function () {
		function addEvent(element, evnt, funct) {
			if (element.attachEvent)
				return element.attachEvent('on' + evnt, funct);
			else
				return element.addEventListener(evnt, funct, false);
		}

		var slideout = new Slideout({
			'panel': document.getElementById('cMainPanel'),
			'menu': document.getElementById('cSide'),
			'padding': 300,
			'tolerance': 70,
			'side': 'right'
		});
		addEvent(
			document.getElementById('cBtnSlide'),
			'click',
			function () {
				slideout.toggle();
			}
		);
	})();
</script>



<script async src="https://cdn.ampproject.org/v0.js"></script>
<script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>

</body>
</html>