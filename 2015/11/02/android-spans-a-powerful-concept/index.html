<!DOCTYPE html>
<html>

<head>
	<title>Android : Spans, a Powerful Concept</title>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<meta name="author" content="유영재">
	<meta name="keywords" content="Android : Spans, a Powerful Concept,android,이 세상에 하나는 남기고 가자"/>
	<meta name="description" content="Android : Spans, a Powerful Concept,android,안드로이드의 Spannable에 관련된 좋은 글이 있어 번역해 본다.사실 부족한 영어 실력으로 번역이라기 보다 내용을 옮겨보는 정도라고 생각하면 될 듯하다(의역이 많다).  Spans, a Powerful Concept.Jan 31st, 2014 6:09 pmGithub Sampl..."/>

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- http://opengraphprotocol.org/ -->
	<meta name="twitter:card" content="summary_large_image">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://blog.asamaru.net/2015/11/02/android-spans-a-powerful-concept/">
	<meta property="og:title" content="Android : Spans, a Powerful Concept">
	

	<link rel="canonical" href="https://blog.asamaru.net/2015/11/02/android-spans-a-powerful-concept/"/>
	<link rel="shortcut icon" type="image/x-icon" media="screen" href="https://blog.asamaru.net/favicon.ico"/>
	<link rel="alternate" type="application/rss+xml" title="이 세상에 하나는 남기고 가자" href="https://blog.asamaru.net/atom.xml"/>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/style.css"/>
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/highlight.css"/>

	
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/post.css"/>
	
	

	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
					(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-65749108-2', 'auto');
		ga('send', 'pageview');

	</script>
</head>


<body>
<div class="main">

	<nav class="navbar navbar-default" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">이 세상에 하나는 남기고 가자</a>
		</div>

		<div class="navbar-collapse collapse">
			
			<ul class="nav navbar-nav">
				<li class="active">
				<a rel="index" href="/">Blog</a>
				</li>
				<li >
				<a href="/archives/">Archives</a>
				</li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a class="subscribe-rss" href="https://blog.asamaru.net/atom.xml" title="subscribe via RSS">
						<span class="visible-xs">RSS</span>
						<img class="hidden-xs" src="/static/img/rss.png" alt="RSS">
					</a>
				</li>
			</ul>
			
			<!-- <form class="navbar-form navbar-right" action="http://www.google.co.kr" id="cse-search-box" target="_blank">
			  <div class="form-group">
			    <input type="hidden" name="cx" value="partner-pub-8163803188491150:6044663021" />
			    <input type="hidden" name="ie" value="UTF-8" />
			    <input type="text" name="q" class="form-control" />
			    <input type="submit" name="sa" value="&#xac80;&#xc0c9;" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.co.kr/coop/cse/brand?form=cse-search-box&amp;lang=ko"></script> -->
			<form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
				<input type="hidden" name="sitesearch" value="https://blog.asamaru.net">
				<div class="form-group">
					<input class="form-control" type="text" name="q" placeholder="Search">
				</div>
			</form>
			
		</div>
	</div>
</nav>


	<div class="container">
		<div class="row">
	<div class="content col-lg-9">
		<div class="sheet post">
			<header>
				<h2>Android : Spans, a Powerful Concept</h2>
				<p class="post-meta">
					<!--<span class="glyphicon glyphicon-calendar"></span>--> 2015.11.02.
					
					&nbsp;&nbsp;&nbsp;
					<span>
						<a href="https://blog.asamaru.net/category/android/"><span class="glyphicon glyphicon-list"></span>&nbsp;android</a>
					</span>
					<span>
                </span>
				</p>
			</header>
			<hr class="boundary">
			<article>
				<!-- Topic of Contents -->
				<!--
								<section class="panel panel-default cToc">
									<div class="panel-heading">
										<h3 class="panel-title">Topic of Contents</h3>
									</div>
									<ul class="list-group">
										<li class="list-group-item toc">
										</li>
									</ul>
								</section>
				-->

				<p>안드로이드의 <a href="http://developer.android.com/intl/ru/reference/android/text/Spannable.html">Spannable</a>에 관련된 좋은 글이 있어 번역해 본다.
사실 부족한 영어 실력으로 번역이라기 보다 내용을 옮겨보는 정도라고 생각하면 될 듯하다(의역이 많다).</p>

<blockquote>
  <p><a href="http://flavienlaurent.com/blog/2014/01/31/spans/">Spans, a Powerful Concept.</a><br />
Jan 31st, 2014 6:09 pm<br />
<a href="https://github.com/flavienlaurent/spans">Github Sample : flavienlaurent/spans</a></p>
</blockquote>

<p>최근에, 나는 NewStand 앱과 ActionBar icon의 전환 효과에 대해 블로그에 남겼다. Cyril Mottier는 ActionBar의 title에 Spans을 사용하여 fade in/out하는 우아한 방법을 제안했다.</p>

<p>또한, 난 항상 사용 가능한 모든 종류의 Span(ImageSpan, BackgroundColorSpan 등)을 시도하고 싶었다. 그것들은 매우 유용하고 사용이 간단하지만 그것들에 대한 문서나 자세한 정보가 없었다.</p>

<p>그래서 이 문서에는 프레임워크의 Spans으로 무엇을 할 수 있는지 탐색하고, Spans으로 어떠한 새로운 것을 할 수 있는지 보여주고자 한다. <a href="https://github.com/flavienlaurent/spans/raw/master/sample.apk">sample application</a>를 다운받아 설치할 수 있다. 여기에서 <a href="https://github.com/flavienlaurent/spans">source</a>를 확인 할 수 있다.</p>

<h2 id="in-the-framework">In the framework</h2>

<h3 id="hierarchy">HIERARCHY</h3>

<p>Main rules:</p>

<ul>
  <li>Span이 텍스트 문자 레벨에 영향을 미칠 경우, <a href="http://developer.android.com/reference/android/text/style/CharacterStyle.html">CharacterStyle</a>를 상속</li>
  <li>Span이 단락 레벨에 영향을 미칠 경우, <a href="http://developer.android.com/reference/android/text/style/ParagraphStyle.html">ParagraphStyle</a>를 상속</li>
  <li>Span이 텍스트 문자 레벨의 외형에 영향을 미칠 경우,
<a href="http://developer.android.com/reference/android/text/style/UpdateAppearance.html">UpdateAppearance</a>를 상속</li>
  <li>Span이 단락 레벨의 외형에 영향을 미칠 경우, <a href="http://developer.android.com/reference/android/text/style/UpdateLayout.html">UpdateLayout</a>를 상속</li>
</ul>

<p>그것은 우리를 위해 다음과 같은 클래스 다이어그램을 제공합니다 :</p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-1.png" alt="cdcharacterstyle" /></p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-2.png" alt="cdparagraphstyle" /></p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-3.png" alt="cdupdateappearance" /></p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-4.png" alt="cdupdatelayout" /></p>

<p>그러나 이것은 조금 복잡하기 때문에 나는 class visualizer (like <a href="http://www.class-visualizer.net/">this</a>)를 사용하길 권한다.</p>

<h2 id="how-it-works">How it works?</h2>

<h3 id="layout">LAYOUT</h3>

<p>당신이 text를 TextView에 설정하고자 할때, <a href="http://developer.android.com/reference/android/text/Layout.html">Layout</a> base class를 사용하여 텍스트 렌더링을 관리한다.</p>

<p>Layout Class는 <code class="highlighter-rouge">mSpannedText</code>라는 boolean 값을 포함하고 있다: text가 <a href="http://developer.android.com/reference/android/text/Spanned.html">Spanned</a>(<a href="http://developer.android.com/reference/android/text/Spanned.html">Spanned</a>을 구현한 <a href="http://developer.android.com/reference/android/text/SpannableString.html">SpannableString</a>)의 인스턴스라면 true가 된다.
이 Class는 오직 ParagraphStyle Spans에만 동작한다.</p>

<p><a href="http://developer.android.com/reference/android/text/Layout.html#draw%28android.graphics.Canvas,%20android.graphics.Path,%20android.graphics.Paint,%20int%29">draw</a> method는 2개의 다른 method들을 호출한다:</p>

<ul>
  <li>drawBackground</li>
</ul>

<p>텍스트의 각 행에 대해, 현재 행에  <a href="http://developer.android.com/reference/android/text/style/LineBackgroundSpan.html">LineBackgroundSpan</a>가 있는 경우, <a href="http://developer.android.com/reference/android/text/style/LineBackgroundSpan.html#drawBackground%28android.graphics.Canvas,%20android.graphics.Paint,%20int,%20int,%20int,%20int,%20int,%20java.lang.CharSequence,%20int,%20int,%20int%29">LineBackgroundSpan#drawBackground</a>가 호출된다.</p>

<ul>
  <li>drawText</li>
</ul>

<p>텍스트의 각 행에 대해, <a href="http://developer.android.com/reference/android/text/style/LeadingMarginSpan.html">LeadingMarginSpan</a>과 <a href="http://developer.android.com/reference/android/text/style/LeadingMarginSpan.LeadingMarginSpan2.html">LeadingMarginSpan2</a>를 계산하고 필요하다면 <a href="http://developer.android.com/reference/android/text/style/LeadingMarginSpan.html#drawLeadingMargin%28android.graphics.Canvas,%20android.graphics.Paint,%20int,%20int,%20int,%20int,%20int,%20java.lang.CharSequence,%20int,%20int,%20boolean,%20android.text.Layout%29">LeadingMarginSpan#drawLeadingMargin</a>를 호출한다. 이것은 또한 <a href="http://developer.android.com/reference/android/text/style/AlignmentSpan.html">AlignmentSpan</a>를 텍스트 맞춤을 결정 하는 데 사용 된다. 마지막으로, 현재 행이 스팬인 경우, 레이아웃은 TextLine#draw(텍스트 라인 개체가 각 행에 대해 생성된다)을 호출 한다.</p>

<h3 id="textline">TEXTLINE</h3>

<p>문서에서는 <a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/text/TextLine.java">android.text.TextLine</a> 다음과 같이 설명한다: 시각적 순서의 측정과 렌더링을 위한 스타일 텍스트 행을 나타낸다.</p>

<p>TextLine 클래스는 3세트의 Spans을 포함한다:</p>

<ul>
  <li>MetricAffectingSpan set</li>
  <li>CharacterStyle set</li>
  <li>ReplacementSpan set</li>
</ul>

<p>흥미로운 메소드는 TextLine#handleRun이다. 그것은 모든 스팬이 텍스트를 렌더링하는데 사용된다. 스팬의 유형을 기준으로 TextLine은 아래의 함수를 호출한다:</p>

<ul>
  <li><a href="http://developer.android.com/reference/android/text/style/CharacterStyle.html#updateDrawState%28android.text.TextPaint%29">CharacterStyle#updateDrawState</a> to change the TextPaint configuration for MetricAffectingSpan and CharacterStyle Spans.</li>
  <li>TextLine#handleReplacement for ReplacementSpan. It calls <a href="http://developer.android.com/reference/android/text/style/ReplacementSpan.html#getSize%28android.graphics.Paint,%20java.lang.CharSequence,%20int,%20int,%20android.graphics.Paint.FontMetricsInt%29">Replacement#getSize</a> to get the replacement width, update the font metrics if it’s needed and finally call <a href="http://developer.android.com/reference/android/text/style/ReplacementSpan.html#draw%28android.graphics.Canvas,%20java.lang.CharSequence,%20int,%20int,%20float,%20int,%20int,%20int,%20android.graphics.Paint%29">Replacement#draw</a>.</li>
</ul>

<h3 id="fontmetrics">FONTMETRICS</h3>

<p>폰트 메트릭에 대해 더 알고 싶다면 다음의 그림을 보자:</p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-5.png" alt="fontmetrics" /></p>

<h2 id="playground">Playground</h2>

<h3 id="bulletspan">BULLETSPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/BulletSpan.html">android.text.style.BulletSpan</a></p>

<p>The BulletSpan affects paragraph-level text formatting. It allows you to put a bullet on paragraph start.</p>

<p>BulletSpan은 텍스트 단락 수준 서식에 영향을 준다. 그것은 단락 시작에 bullet을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public BulletSpan (int gapWidth, int color)
-gapWidth: gap in px between bullet and text
-color: bullet color (optionnal, default is transparent)
*/</span>

<span class="c1">//create a black BulletSpan with a gap of 15px</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BulletSpan</span><span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-6.png" alt="BulletSpan" /></p>

<h3 id="quotespan">QUOTESPAN</h3>
<p><a href="http://developer.android.com/reference/android/text/style/QuoteSpan.html">android.text.style.QuoteSpan</a></p>

<p>QuoteSpan은 텍스트 단락 수준 서식에 영향을 준다. 그것은 당신이 단락에 인용 수직선을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public QuoteSpan (int color)
-color: quote vertical line color (optionnal, default is Color.BLUE)
*/</span>

<span class="c1">//create a red quote</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QuoteSpan</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">RED</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-7.png" alt="QuoteSpan" /></p>

<h3 id="alignmentspanstandard">ALIGNMENTSPAN.STANDARD</h3>

<p><a href="http://developer.android.com/reference/android/text/style/AlignmentSpan.Standard.html">android.text.style.AlignmentSpan.Standard</a></p>

<p>AlignmentSpan.Standard은 텍스트 단락 수준 서식에 영향을 준다. 그것은 문단을 정렬(일반, 중앙, 반대) 할 수 있도록 해준다.
그것은 정렬 수 있습니다 (정상, 센터, 반대)는 단락.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public Standard(Layout.Alignment align)
-align: alignment to set
*/</span>

<span class="c1">//align center a paragraph</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AlignmentSpan</span><span class="o">.</span><span class="na">Standard</span><span class="o">(</span><span class="n">Layout</span><span class="o">.</span><span class="na">Alignment</span><span class="o">.</span><span class="na">ALIGN_CENTER</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-8.png" alt="AlignmentSpan" /></p>

<h3 id="underlinespan">UNDERLINESPAN</h3>
<p><a href="http://developer.android.com/reference/android/text/style/UnderlineSpan.html">android.text.style.UnderlineSpan</a></p>

<p>UnderlineSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 <a href="http://developer.android.com/reference/android/graphics/Paint.html#setUnderlineText%28boolean%29">Paint#setUnderlineText(true)</a>을 통해 문자에 밑줄을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//underline a character</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UnderlineSpan</span><span class="o">();</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-9.png" alt="UnderlineSpan" /></p>

<h3 id="strikethroughspan">STRIKETHROUGHSPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/StrikethroughSpan.html">android.text.style.StrikethroughSpan</a></p>

<p>StrikethroughSpan 은 텍스트 글자 수준 서식에 영향을 준다. 그것은  <a href="http://developer.android.com/reference/android/graphics/Paint.html#setStrikeThruText%28boolean%29">Paint#setStrikeThruText(true)</a>을 통해 문자에 취소선을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//strikethrough a character</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StrikethroughSpan</span><span class="o">();</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-10.png" alt="StrikethroughSpan" /></p>

<h3 id="subscriptspan">SUBSCRIPTSPAN</h3>
<p><a href="http://developer.android.com/reference/android/text/style/SubscriptSpan.html">android.text.style.SubscriptSpan</a></p>

<p>SubscriptSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은  <a href="http://developer.android.com/reference/android/text/TextPaint.html#baselineShift">TextPaint#baselineShift</a>를 감소시켜 아래 첨자 문자를 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//subscript a character</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubscriptSpan</span><span class="o">();</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-11.png" alt="SubscriptSpan" /></p>

<h3 id="superscriptspan">SUPERSCRIPTSPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/SuperscriptSpan.html">android.text.style.SuperscriptSpan</a></p>

<p>SuperscriptSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은  <a href="http://developer.android.com/reference/android/text/TextPaint.html#baselineShift">TextPaint#baselineShift</a>를 증가시켜 위 첨자 문자를 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//superscript a character</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SuperscriptSpan</span><span class="o">();</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-12.png" alt="SuperscriptSpan" /></p>

<h3 id="backgroundcolorspan">BACKGROUNDCOLORSPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/BackgroundColorSpan.html">android.text.style.BackgroundColorSpan</a></p>

<p>BackgroundColorSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 문자의 배경색을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public BackgroundColorSpan (int color)
-color: background color
*/</span>

<span class="c1">//set a green background</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BackgroundColorSpan</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">GREEN</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-13.png" alt="BackgroundColorSpan" /></p>

<h3 id="foregroundcolorspan">FOREGROUNDCOLORSPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/ForegroundColorSpan.html">android.text.style.ForegroundColorSpan</a></p>

<p>ForegroundColorSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 문자의 글자색을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public ForegroundColorSpan (int color)
-color: foreground color
*/</span>

<span class="c1">//set a red foreground</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ForegroundColorSpan</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">RED</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-14.png" alt="ForegroundColorSpan" /></p>

<h3 id="imagespan">IMAGESPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/ImageSpan.html">android.text.style.ImageSpan</a></p>

<p>ImageSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 이미지를 글자처럼 넣을 수 있도록 해준다. 그것은 문서화를 잘 할 수 있도록 해주는 몇 안되는 스팬 중 하나다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//replace a character by pic1_small image</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageSpan</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">pic1_small</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-15.png" alt="ImageSpan" /></p>

<h3 id="stylespan">STYLESPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/StyleSpan.html">android.text.style.StyleSpan</a></p>

<p>StyleSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 글자에 스타일(bold, italic, normal)을 넣을 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public StyleSpan (int style)
-style: int describing the style (android.graphics.Typeface)
*/</span>

<span class="c1">//set a bold+italic style</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StyleSpan</span><span class="o">(</span><span class="n">Typeface</span><span class="o">.</span><span class="na">BOLD</span> <span class="o">|</span> <span class="n">Typeface</span><span class="o">.</span><span class="na">ITALIC</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-16.png" alt="StyleSpan" /></p>

<h3 id="typefacespan">TYPEFACESPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/TypefaceSpan.html">android.text.style.TypefaceSpan</a></p>

<p>TypefaceSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것의 글자의 폰트 패밀리(monospace, serif etc)를 지정할 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public TypefaceSpan (String family)
-family: a font family
*/</span>

<span class="c1">//set the serif family</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TypefaceSpan</span><span class="o">(</span><span class="s">"serif"</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-17.png" alt="TypefaceSpan" /></p>

<h3 id="textappearancespan">TEXTAPPEARANCESPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/TextAppearanceSpan.html">android.text.style.TextAppearanceSpan</a></p>

<p>TextAppearanceSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 글자의 appearance를 지정할 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public  TextAppearanceSpan(Context context, int appearance, int colorList)
-context: a valid context
-appearance: text appearance resource (ex: android.R.style.TextAppearance_Small)
-colorList: a text color resource (ex: android.R.styleable.Theme_textColorPrimary)

public TextAppearanceSpan(String family, int style, int size, ColorStateList color, ColorStateList linkColor)
-family: a font family
-style: int describing the style (android.graphics.Typeface)
-size: text size
-color: a text color
-linkColor: a link text color
*/</span>

<span class="c1">//set the serif family</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextAppearanceSpan</span><span class="o">(</span><span class="k">this</span><span class="cm">/*a context*/</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">style</span><span class="o">.</span><span class="na">SpecialTextAppearance</span><span class="o">);</span>
</code></pre>
</div>

<p><strong>styles.xml</strong></p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;style</span> <span class="na">name=</span><span class="s">"SpecialTextAppearance"</span> <span class="na">parent=</span><span class="s">"@android:style/TextAppearance"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"android:textColor"</span><span class="nt">&gt;</span>@color/color1<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"android:textColorHighlight"</span><span class="nt">&gt;</span>@color/color2<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"android:textColorHint"</span><span class="nt">&gt;</span>@color/color3<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"android:textColorLink"</span><span class="nt">&gt;</span>@color/color4<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"android:textSize"</span><span class="nt">&gt;</span>28sp<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"android:textStyle"</span><span class="nt">&gt;</span>italic<span class="nt">&lt;/item&gt;</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-18.png" alt="TextAppearanceSpan" /></p>

<h3 id="absolutesizespan">ABSOLUTESIZESPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/AbsoluteSizeSpan.html">android.text.style.AbsoluteSizeSpan</a></p>

<p>AbsoluteSizeSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 글자의 절대 크기를 지정할 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public AbsoluteSizeSpan(int size, boolean dip)
-size: a size
-dip: false, size is in px; true, size is in dip (optionnal, default false)
*/</span>

<span class="c1">//set text size to 24dp</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AbsoluteSizeSpan</span><span class="o">(</span><span class="mi">24</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-19.png" alt="AbsoluteSizeSpan" /></p>

<h3 id="relativesizespan">RELATIVESIZESPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/RelativeSizeSpan.html">android.text.style.RelativeSizeSpan</a></p>

<p>RelativeSizeSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 글자의 상대 크기를 지정할 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public RelativeSizeSpan(float proportion)
-proportion: a proportion of the actual text size
*/</span>

<span class="c1">//set text size 2 times bigger</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RelativeSizeSpan</span><span class="o">(</span><span class="mf">2.0f</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-20.png" alt="RelativeSizeSpan" /></p>

<h2 id="scalexspan">SCALEXSPAN</h2>

<p><a href="http://developer.android.com/reference/android/text/style/ScaleXSpan.html">android.text.style.ScaleXSpan</a></p>

<p>ScaleXSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 글자의 x 축 방향에 설정된 배율을 지정할 수 있도록 해준다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public ScaleXSpan(float proportion)
-proportion: a proportion of actual text scale x
*/</span>

<span class="c1">//scale x 3 times bigger</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ScaleXSpan</span><span class="o">(</span><span class="mf">3.0f</span><span class="o">);</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-21.png" alt="ScaleXSpan" /></p>

<h3 id="maskfilterspan">MASKFILTERSPAN</h3>

<p><a href="http://developer.android.com/reference/android/text/style/MaskFilterSpan.html">android.text.style.MaskFilterSpan</a></p>

<p>MaskFilterSpan은 텍스트 글자 수준 서식에 영향을 준다. 그것은 글자에  <a href="http://developer.android.com/reference/android/graphics/MaskFilter.html">android.graphics.MaskFilter</a>를 설정할 수 있도록 해준다.</p>

<p><strong>주의: BlurMaskFilter 는 hardware acceleration을 지원하지 않는다.</strong></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/*
public MaskFilterSpan(MaskFilter filter)
-filter: a filter to apply
*/</span>

<span class="c1">//Blur a character</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MaskFilterSpan</span><span class="o">(</span><span class="k">new</span> <span class="n">BlurMaskFilter</span><span class="o">(</span><span class="n">density</span><span class="o">*</span><span class="mi">2</span><span class="o">,</span> <span class="n">BlurMaskFilter</span><span class="o">.</span><span class="na">Blur</span><span class="o">.</span><span class="na">NORMAL</span><span class="o">));</span>
<span class="c1">//Emboss a character</span>
<span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MaskFilterSpan</span><span class="o">(</span><span class="k">new</span> <span class="n">EmbossMaskFilter</span><span class="o">(</span><span class="k">new</span> <span class="kt">float</span><span class="o">[]</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span> <span class="o">},</span> <span class="mf">0.4f</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mf">3.5f</span><span class="o">));</span>
</code></pre>
</div>

<p><strong>BlurMaskFilter</strong></p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-22.png" alt="MaskFilterSpan" /></p>

<p><strong>EmbossMaskFilter와 함께 blue ForegroundColorSpan과 bold StyleSpan</strong></p>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-23.png" alt="MaskFilterSpan" /></p>

<h2 id="pushing-spans-to-the-next-level">고급 스팬(Pushing Spans to the next level)</h2>

<h3 id="foreground-color-">글자색(FOREGROUND COLOR) 애니메이션</h3>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-24.gif" alt="AnimateSpan" /></p>

<p>ForegroundColorSpan은 읽기 전용이다. 그것은 인스턴스화된 후에는 글자색을 변경할 수 없다는 뜻이다. 따라서 처음으로 할 일은 MutableForegroundColorSpan을 작성하는 것이다.</p>

<p><strong>MutableForegroundColorSpan.java</strong></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MutableForegroundColorSpan</span> <span class="kd">extends</span> <span class="n">ForegroundColorSpan</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">mAlpha</span> <span class="o">=</span> <span class="mi">255</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">mForegroundColor</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MutableForegroundColorSpan</span><span class="o">(</span><span class="kt">int</span> <span class="n">alpha</span><span class="o">,</span> <span class="kt">int</span> <span class="n">color</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">color</span><span class="o">);</span>
        <span class="n">mAlpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">;</span>
        <span class="n">mForegroundColor</span> <span class="o">=</span> <span class="n">color</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">MutableForegroundColorSpan</span><span class="o">(</span><span class="n">Parcel</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">src</span><span class="o">);</span>
        <span class="n">mForegroundColor</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="na">readInt</span><span class="o">();</span>
        <span class="n">mAlpha</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="na">readInt</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">writeToParcel</span><span class="o">(</span><span class="n">Parcel</span> <span class="n">dest</span><span class="o">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">writeToParcel</span><span class="o">(</span><span class="n">dest</span><span class="o">,</span> <span class="n">flags</span><span class="o">);</span>
        <span class="n">dest</span><span class="o">.</span><span class="na">writeInt</span><span class="o">(</span><span class="n">mForegroundColor</span><span class="o">);</span>
        <span class="n">dest</span><span class="o">.</span><span class="na">writeFloat</span><span class="o">(</span><span class="n">mAlpha</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateDrawState</span><span class="o">(</span><span class="n">TextPaint</span> <span class="n">ds</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">getForegroundColor</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="cm">/**
     * @param alpha from 0 to 255
     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAlpha</span><span class="o">(</span><span class="kt">int</span> <span class="n">alpha</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mAlpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setForegroundColor</span><span class="o">(</span><span class="kt">int</span> <span class="n">foregroundColor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mForegroundColor</span> <span class="o">=</span> <span class="n">foregroundColor</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">getAlpha</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mAlpha</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getForegroundColor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Color</span><span class="o">.</span><span class="na">argb</span><span class="o">(</span><span class="n">mAlpha</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">(</span><span class="n">mForegroundColor</span><span class="o">),</span> <span class="n">Color</span><span class="o">.</span><span class="na">green</span><span class="o">(</span><span class="n">mForegroundColor</span><span class="o">),</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">(</span><span class="n">mForegroundColor</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>이제 우리는 같은 인스턴스에서 투명도 또는 글자색을 변경할 수 있다. 그러나 그 속성을 설정할 때 그것은 View를 갱신하지 않는다: 직접 SpannableString을 다시 설정해 주어야 한다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">MutableForegroundColorSpan</span> <span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MutableForegroundColorSpan</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span>
<span class="n">spannableString</span><span class="o">.</span><span class="na">setSpan</span><span class="o">(</span><span class="n">span</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">text</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="n">Spanned</span><span class="o">.</span><span class="na">SPAN_EXCLUSIVE_EXCLUSIVE</span><span class="o">);</span>
<span class="n">textView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">spannableString</span><span class="o">);</span>
<span class="c1">//here the text is black and fully opaque</span>
<span class="n">span</span><span class="o">.</span><span class="na">setAlpha</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="n">span</span><span class="o">.</span><span class="na">setForegroundColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">RED</span><span class="o">);</span>
<span class="c1">//here the text hasn't changed.</span>
<span class="n">textView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">spannableString</span><span class="o">);</span>
<span class="c1">//finally, the text is red and translucent</span>
</code></pre>
</div>

<p>이제 우리는 글자색을 애니메이션하기를 원한다. 우리는  <a href="http://developer.android.com/reference/android/util/Property.html">android.util.Property</a>를 사용하여 커스텀 해야 한다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Property</span><span class="o">&lt;</span><span class="n">MutableForegroundColorSpan</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">MUTABLE_FOREGROUND_COLOR_SPAN_FC_PROPERTY</span> <span class="o">=</span>
<span class="k">new</span> <span class="n">Property</span><span class="o">&lt;</span><span class="n">MutableForegroundColorSpan</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"MUTABLE_FOREGROUND_COLOR_SPAN_FC_PROPERTY"</span><span class="o">)</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">MutableForegroundColorSpan</span> <span class="n">span</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">span</span><span class="o">.</span><span class="na">setForegroundColor</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">get</span><span class="o">(</span><span class="n">MutableForegroundColorSpan</span> <span class="n">span</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">span</span><span class="o">.</span><span class="na">getForegroundColor</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">};</span>
</code></pre>
</div>

<p>마지막으로 우리는 <a href="http://developer.android.com/reference/android/animation/ObjectAnimator.html">ObjectAnimator</a>를 이용하여 custom property를 애니메이션 한다. View를 갱신하는 것을 잊지마라.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">MutableForegroundColorSpan</span> <span class="n">span</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MutableForegroundColorSpan</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span>
<span class="n">mSpannableString</span><span class="o">.</span><span class="na">setSpan</span><span class="o">(</span><span class="n">span</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">text</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="n">Spanned</span><span class="o">.</span><span class="na">SPAN_EXCLUSIVE_EXCLUSIVE</span><span class="o">);</span>
<span class="n">ObjectAnimator</span> <span class="n">objectAnimator</span> <span class="o">=</span> <span class="n">ObjectAnimator</span><span class="o">.</span><span class="na">ofInt</span><span class="o">(</span><span class="n">span</span><span class="o">,</span> <span class="n">MUTABLE_FOREGROUND_COLOR_SPAN_FC_PROPERTY</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">RED</span><span class="o">);</span>
<span class="n">objectAnimator</span><span class="o">.</span><span class="na">setEvaluator</span><span class="o">(</span><span class="k">new</span> <span class="n">ArgbEvaluator</span><span class="o">());</span>
<span class="n">objectAnimator</span><span class="o">.</span><span class="na">addUpdateListener</span><span class="o">(</span><span class="k">new</span> <span class="n">ValueAnimator</span><span class="o">.</span><span class="na">AnimatorUpdateListener</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onAnimationUpdate</span><span class="o">(</span><span class="n">ValueAnimator</span> <span class="n">animation</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//refresh</span>
        <span class="n">mText</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">mSpannableString</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="n">objectAnimator</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</code></pre>
</div>

<h2 id="actionbar-fireworks">ACTIONBAR ‘FIREWORKS’</h2>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-25.gif" alt="FIREWORKS" /></p>

<p>‘fireworks’ 애니메이션은 무작위를 글자를 fade 하도록 한다. 먼저 글자를 다수의 Span으로 분리하여(예를 들어, 글자 단위로 하나의 스팬을 생성) 스팬을 적용하고 fade 한다. 앞서 소개한 MutableForegroundColorSpan을 사용하여, 스팬 그룹을 표현하기 위한 특별한 객체를 만들 것이다. 그리고 그룹에 setAlpha 호출할 때마다, 우리는 무작위로 각 범위에 대한 투명도를 설정한다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">FireworksSpanGroup</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">float</span> <span class="n">mAlpha</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">MutableForegroundColorSpan</span><span class="o">&gt;</span> <span class="n">mSpans</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">FireworksSpanGroup</span><span class="o">(</span><span class="kt">float</span> <span class="n">alpha</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mAlpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">;</span>
        <span class="n">mSpans</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">MutableForegroundColorSpan</span><span class="o">&gt;();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addSpan</span><span class="o">(</span><span class="n">MutableForegroundColorSpan</span> <span class="n">span</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">span</span><span class="o">.</span><span class="na">setAlpha</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="o">(</span><span class="n">mAlpha</span> <span class="o">*</span> <span class="mi">255</span><span class="o">));</span>
        <span class="n">mSpans</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">span</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">mSpans</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAlpha</span><span class="o">(</span><span class="kt">float</span> <span class="n">alpha</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">mSpans</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
        <span class="kt">float</span> <span class="n">total</span> <span class="o">=</span> <span class="mf">1.0f</span> <span class="o">*</span> <span class="n">size</span> <span class="o">*</span> <span class="n">alpha</span><span class="o">;</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">index</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">MutableForegroundColorSpan</span> <span class="n">span</span> <span class="o">=</span> <span class="n">mSpans</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span><span class="n">total</span> <span class="o">&gt;=</span> <span class="mf">1.0f</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">span</span><span class="o">.</span><span class="na">setAlpha</span><span class="o">(</span><span class="mi">255</span><span class="o">);</span>
                <span class="n">total</span> <span class="o">-=</span> <span class="mf">1.0f</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">span</span><span class="o">.</span><span class="na">setAlpha</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="o">(</span><span class="n">total</span> <span class="o">*</span> <span class="mi">255</span><span class="o">));</span>
                <span class="n">total</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">getAlpha</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">mAlpha</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>우리는 FireworksSpanGroup의 알파 애니메이션에 사용자 정의 속성을 만든다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Property</span><span class="o">&lt;</span><span class="n">FireworksSpanGroup</span><span class="o">,</span> <span class="n">Float</span><span class="o">&gt;</span> <span class="n">FIREWORKS_GROUP_PROGRESS_PROPERTY</span> <span class="o">=</span>
<span class="k">new</span> <span class="n">Property</span><span class="o">&lt;</span><span class="n">FireworksSpanGroup</span><span class="o">,</span> <span class="n">Float</span><span class="o">&gt;(</span><span class="n">Float</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"FIREWORKS_GROUP_PROGRESS_PROPERTY"</span><span class="o">)</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">FireworksSpanGroup</span> <span class="n">spanGroup</span><span class="o">,</span> <span class="n">Float</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">spanGroup</span><span class="o">.</span><span class="na">setProgress</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Float</span> <span class="nf">get</span><span class="o">(</span><span class="n">FireworksSpanGroup</span> <span class="n">spanGroup</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">spanGroup</span><span class="o">.</span><span class="na">getProgress</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">};</span>
</code></pre>
</div>

<p>마지막으로, 우리는 그룹을 만들고 ObjectAnimator으로 애니메이션 한다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">final</span> <span class="n">FireworksSpanGroup</span> <span class="n">spanGroup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FireworksSpanGroup</span><span class="o">();</span>
<span class="c1">//init the group with multiple spans</span>
<span class="c1">//spanGroup.addSpan(span);</span>
<span class="c1">//set spans on the ActionBar spannable title</span>
<span class="c1">//mActionBarTitleSpannableString.setSpan(span, start, end, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);</span>
<span class="n">spanGroup</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>
<span class="n">ObjectAnimator</span> <span class="n">objectAnimator</span> <span class="o">=</span> <span class="n">ObjectAnimator</span><span class="o">.</span><span class="na">ofFloat</span><span class="o">(</span><span class="n">spanGroup</span><span class="o">,</span> <span class="n">FIREWORKS_GROUP_PROGRESS_PROPERTY</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">,</span> <span class="mf">1.0f</span><span class="o">);</span>
<span class="n">objectAnimator</span><span class="o">.</span><span class="na">addUpdateListener</span><span class="o">(</span><span class="k">new</span> <span class="n">ValueAnimator</span><span class="o">.</span><span class="na">AnimatorUpdateListener</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onAnimationUpdate</span><span class="o">(</span><span class="n">ValueAnimator</span> <span class="n">animation</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//refresh the ActionBar title</span>
        <span class="n">setTitle</span><span class="o">(</span><span class="n">mActionBarTitleSpannableString</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="n">objectAnimator</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</code></pre>
</div>

<h2 id="draw-with-your-own-span">나만의 스팬으로 그리기(DRAW WITH YOUR OWN SPAN)</h2>

<p>이 섹션에서는 사용자 정의 스팬을 통해 그리는 방법을 설명 할 것이다. 이것은 텍스트 사용자 정의에 대한 흥미로운 관점을 열어줄 것이다.</p>

<p>첫째, 우리는 추상 클래스 <a href="http://developer.android.com/reference/android/text/style/ReplacementSpan.html">ReplacementSpan</a>을 확장하는 커스텀 스팬을 만들어야 한다.</p>

<p>당신이 오직 custom background를 그리기만 원하는 경우, 텍스트 단락 수준 서식인 <a href="http://developer.android.com/reference/android/text/style/LineBackgroundSpan.html">LineBackgroundSpan</a>을 구현할 수 있다.</p>

<p>우리는 2개의 methods를 구현해야 한다:</p>

<ul>
  <li><a href="http://developer.android.com/reference/android/text/style/ReplacementSpan.html#getSize%28android.graphics.Paint,%20java.lang.CharSequence,%20int,%20int,%20android.graphics.Paint.FontMetricsInt%29">getSize</a>: 이 method는 당신이 변경한 새로운 크기를 반환한다.</li>
</ul>

<p>text: 스팬에서 관리하는 문자열</p>

<p>start: 문자열의 시작 위치</p>

<p>end: 문자열의 종료 위치</p>

<p>fm: font metrics(null을 넣을 수 있다)</p>

<ul>
  <li><a href="http://developer.android.com/reference/android/text/style/ReplacementSpan.html#draw%28android.graphics.Canvas,%20java.lang.CharSequence,%20int,%20int,%20float,%20int,%20int,%20int,%20android.graphics.Paint%29">draw</a>: 당신이 Canvas를 이용해 그릴 수 있는 곳이다.</li>
</ul>

<p>x: 문자열이 draw 될 좌표(x-coordinate)</p>

<p>top: 라인의 top</p>

<p>y: baseline</p>

<p>bottom: 라인의 bottom</p>

<p>텍스트를 둘러싸는 파란 사각형을 그리는 예제를 보자.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">getSize</span><span class="o">(</span><span class="n">Paint</span> <span class="n">paint</span><span class="o">,</span> <span class="n">CharSequence</span> <span class="n">text</span><span class="o">,</span> <span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">,</span> <span class="n">Paint</span><span class="o">.</span><span class="na">FontMetricsInt</span> <span class="n">fm</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//return text with relative to the Paint</span>
    <span class="n">mWidth</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">paint</span><span class="o">.</span><span class="na">measureText</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">mWidth</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">(</span><span class="n">Canvas</span> <span class="n">canvas</span><span class="o">,</span> <span class="n">CharSequence</span> <span class="n">text</span><span class="o">,</span> <span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">,</span> <span class="kt">float</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">top</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">,</span> <span class="kt">int</span> <span class="n">bottom</span><span class="o">,</span> <span class="n">Paint</span> <span class="n">paint</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//draw the frame with custom Paint</span>
    <span class="n">canvas</span><span class="o">.</span><span class="na">drawRect</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">top</span><span class="o">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">mWidth</span><span class="o">,</span> <span class="n">bottom</span><span class="o">,</span> <span class="n">mPaint</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-26.png" alt="DRAW WITH YOUR OWN SPAN" /></p>

<h2 id="bonus">BONUS</h2>

<p>샘플 앱에는 아래와 같은 예시가 포함되어 있다:</p>

<ul>
  <li>Progressive blur</li>
</ul>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-27.gif" alt="Progressive blur" /></p>

<ul>
  <li>Typewriter</li>
</ul>

<p><img src="/img/2015-11-02-android-spans-a-powerful-concept-28.gif" alt="Typewriter" /></p>

<h2 id="section">결론</h2>

<p>이 문서에서 작업, 나는 스팬 정말 강력하고 드로어 블 Drawable들처럼, 나는 그들이 충분히 사용하지 않는 생각을 깨달았다. 텍스트 응용 프로그램의 주요 내용, 그것은 사방 그래서 스팬과 더 역동적이고 매력적으로 만들 것을 잊지 마세요있다!</p>

<p>이 문서 작업, 깨달았다 범위는 정말 강력 하 고 Drawables, 같은 그들이 생각 하지 충분히 사용. 텍스트는 응용 프로그램의 주요 내용, 그것은 어디에 나 그래서 더 역동적이 고 매력적인 걸쳐 그것을 확인 하는 것을 잊지 마세요!</p>

<p>이 문서를 작성하면서 스팬은 정말 강력하지만 그들은 Drawables처럼 충분히 사용하지 않는다는 것을 깨달았다. 텍스트는 어플리케이션의 메인 콘텐츠다. 그것은 어디에나 있다. 그러니 텍스트를 스팬을 통해 역동적이고 매력적으로 만들 수 있다는 것을 잊지마라!</p>

			</article>
			<hr class="boundary">
		</div>

		<!-- adsense -->
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- 블로그 하단 -->
		<ins class="adsbygoogle"
			 style="display:block; margin-bottom:20px;"
			 data-ad-client="ca-pub-8163803188491150"
			 data-ad-slot="7841851420"
			 data-ad-format="auto"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
		<!-- adsense -->

		<div class="pad-min"></div>
		<div id="post-comment" class="sheet post">
			<div id="disqus_thread"></div>
		</div>
	</div>
	<div class="content-navigation col-lg-3">
		<!-- I made it -->
		<section class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">I made it</h3>
			</div>
			<ul class="list-group">
				<li class="list-group-item"><a href="http://sprite.asamaru.net/" target="_blank">Sprite CSS/Image</a></li>
				<li class="list-group-item"><a href="http://loan.asamaru.net/" target="_blank">대출이자계산기</a></li>
				<li class="list-group-item"><a href="http://bookmarklet.asamaru.net/" target="_blank">북마클릿 생성기</a></li>
			</ul>
		</section>

		<!-- Categories -->
		
		
		<section class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">Categories</h3>
			</div>
			<ul class="list-group">
				
				<li class="list-group-item"><a href="/category/thinking/">Thinking <span class="badge">3</span></a></li>
				
				<li class="list-group-item"><a href="/category/osx/">Osx <span class="badge">6</span></a></li>
				
				<li class="list-group-item"><a href="/category/programming/">Programming <span class="badge">1</span></a></li>
				
				<li class="list-group-item"><a href="/category/css/">Css <span class="badge">3</span></a></li>
				
				<li class="list-group-item"><a href="/category/js/">Js <span class="badge">9</span></a></li>
				
				<li class="list-group-item"><a href="/category/android/">Android <span class="badge">53</span></a></li>
				
				<li class="list-group-item"><a href="/category/octopress/">Octopress <span class="badge">8</span></a></li>
				
				<li class="list-group-item"><a href="/category/ios/">Ios <span class="badge">18</span></a></li>
				
				<li class="list-group-item"><a href="/category/php/">Php <span class="badge">21</span></a></li>
				
				<li class="list-group-item"><a href="/category/java/">Java <span class="badge">5</span></a></li>
				
				<li class="list-group-item"><a href="/category/db/">Db <span class="badge">6</span></a></li>
				
				<li class="list-group-item"><a href="/category/html/">Html <span class="badge">2</span></a></li>
				
				<li class="list-group-item"><a href="/category/git/">Git <span class="badge">7</span></a></li>
				
				<li class="list-group-item"><a href="/category/blog/">Blog <span class="badge">1</span></a></li>
				
				<li class="list-group-item"><a href="/category/tip/">Tip <span class="badge">13</span></a></li>
				
				<li class="list-group-item"><a href="/category/linux/">Linux <span class="badge">26</span></a></li>
				
				<li class="list-group-item"><a href="/category/swift/">Swift <span class="badge">6</span></a></li>
				
				<li class="list-group-item"><a href="/category/iOS/">Ios <span class="badge">2</span></a></li>
				
				<li class="list-group-item"><a href="/category/vagrant/">Vagrant <span class="badge">5</span></a></li>
				
				<li class="list-group-item"><a href="/category/jekyll/">Jekyll <span class="badge">2</span></a></li>
				
				<li class="list-group-item"><a href="/category/flash/">Flash <span class="badge">1</span></a></li>
				
			</ul>
		</section>
		
		

		<!-- Tags -->
		
		
		

		<!-- adsense -->
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- 블로그 우측 -->
		<ins class="adsbygoogle"
			 style="display:block; margin-bottom:20px;"
			 data-ad-client="ca-pub-8163803188491150"
			 data-ad-slot="1934918622"
			 data-ad-format="auto"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
		<!-- adsense -->

		<!-- Related -->
		

		

		
		<section class="panel panel-default dRelatedPosts">
			<div class="panel-heading">
				<h3 class="panel-title">Related</h3>
			</div>
			<ul class="list-group">
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/09/27/android-adb-device-reconnect/">안드로이드 스튜디오에서 디바이스 연결이 끊어질 경우 다시 연결하는 방법</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/09/23/google-service-library-9-6-0-used-read-phone-state-permission/">Google Service Library 9.6.0 사용시 READ_PHONE_STATE 권한이 추가되는 문제</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/08/12/playing-html5-video-on-fullscreen-in-android-webview/">안드로이드 WebView에서 HTML5 Video Full Screen 지원</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/08/01/android-webview-resumetimers-pausetimers/">안드로이드 WebView resumeTimers() / pauseTimers() 적용하기</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/07/30/android-4-4-3-4-4-4-webview-referer-doesn-t-work/">Android 4.4.3, 4.4.4 Webview Referer 오류 수정</a></li>
				
			</ul>
		</section>
		

		<section class="panel panel-default">
			<style>
				#google_translate_country { text-align:center; padding-top:5px; }
				#google_translate_element > div { text-align:center; padding:5px 0; }
				#google_translate_element > div > div { display:inline-block; *display:inline; *zoom:1; margin-right:10px; }
			</style>
			<div id="google_translate_country">
				<a href="#googtrans(ko|en)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/English.gif?w=660" alt="English"/></a>
				<!-- <a href="#googtrans(ko|ko)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Korean.gif?w=660" alt="Korean"/></a> -->
				<a href="#googtrans(ko|zh-CN)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Chinese.gif?w=660" alt="Chinese"/></a>
				<a href="#googtrans(ko|ja)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Japanese.gif?w=660" alt="Japanese"/></a>
				<a href="#googtrans(ko|fr)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/French.gif?w=660" alt="French"/></a>
				<a href="#googtrans(ko|de)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/German.gif?w=660" alt="German"/></a>
				<a href="#googtrans(ko|it)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Italian.gif?w=660" alt="Italian"/></a>
			</div>
			<div id="google_translate_element"></div>
			<script type="text/javascript">
				function googleTranslateElementInit() {
					new google.translate.TranslateElement({pageLanguage: 'ko'}, 'google_translate_element');
				}
			</script>
			<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
		</section>
	</div>
</div>


		
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'asamaru7'; // required: replace example with your forum shortname
			// var disqus_developer = 1; // Comment out when the site is live
			var disqus_identifier = "/2015/11/02/android-spans-a-powerful-concept/";

			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var dsq = document.createElement('script');
				dsq.type = 'text/javascript';
				dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		
	</div>

	<div class="page-scrollTop" data-toggle="tooltip" data-placement="top" title="Top">
		<a href="javascript:void(0);">
			<div class="arrow"></div>
			<div class="stick"></div>
		</a>
	</div>
</div>

<footer class="footnote footnote-tiffany">
	<div class="container">
		<a class="foot-item" href="mailto:asamaru@asamaru.net" target="_blank"><img src="/static/img/bottom-email.png" alt="Email"></a>
		<a class="foot-item" href="https://github.com/asamaru7" target="_blank"><img src="/static/img/bottom-github.png" alt="Github"></a>
		<a class="foot-item" href="https://blog.asamaru.net/atom.xml" target="_blank"><img src="/static/img/bottom-rss.png" alt="RSS"></a>
		&nbsp;
		<a href="https://blog.asamaru.net"><span class="word-keep">&copy; 유영재</span></a>
	</div>
</footer>


<div class="scriptHub">
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://blog.asamaru.net/static/js/script.js"></script>

	
	<script type="text/javascript" src="https://blog.asamaru.net/static/js/post.js"></script>
	
	
</div>



</body>
</html>
