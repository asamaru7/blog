<!DOCTYPE html>
<html>

<head>
	<title>SSH 비밀번호 입력없이 로그인하기</title>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<meta name="author" content="유영재">
	<meta name="keywords" content="SSH 비밀번호 입력없이 로그인하기,linux,이 세상에 하나는 남기고 가자"/>
	<meta name="description" content="SSH 비밀번호 입력없이 로그인하기,linux,ssh 사용시 매번 비밀번호를 입력하는 것은 귀찮은 일이다. 그럼에도 불구하고 ssh의 기본 기능에 비밀번호를 미리 입력하는 기능을 제공하지 않는 것은 보안 상의 이유 때문일 것이다. 하지만 비밀번호를 입력하는 귀찮음을 해소하는 것 외에도 스케쥴링 처리 스크립트 등에서 사용자의 비..."/>

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- http://opengraphprotocol.org/ -->
	<meta name="twitter:card" content="summary_large_image">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://blog.asamaru.net/2016/01/26/ssh-login-without-password/">
	<meta property="og:title" content="SSH 비밀번호 입력없이 로그인하기">
	

	<link rel="canonical" href="https://blog.asamaru.net/2016/01/26/ssh-login-without-password/"/>
	<link rel="shortcut icon" type="image/x-icon" media="screen" href="https://blog.asamaru.net/favicon.ico"/>
	<link rel="alternate" type="application/rss+xml" title="이 세상에 하나는 남기고 가자" href="https://blog.asamaru.net/atom.xml"/>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/style.css"/>
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/highlight.css"/>

	
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/post.css"/>
	
	

	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
					(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-65749108-2', 'auto');
		ga('send', 'pageview');

	</script>
</head>


<body>
<div class="main">

	<nav class="navbar navbar-default" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">이 세상에 하나는 남기고 가자</a>
		</div>

		<div class="navbar-collapse collapse">
			
			<ul class="nav navbar-nav">
				<li class="active">
				<a rel="index" href="/">Blog</a>
				</li>
				<li >
				<a href="/archives/">Archives</a>
				</li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a class="subscribe-rss" href="https://blog.asamaru.net/atom.xml" title="subscribe via RSS">
						<span class="visible-xs">RSS</span>
						<img class="hidden-xs" src="/static/img/rss.png" alt="RSS">
					</a>
				</li>
			</ul>
			
			<!-- <form class="navbar-form navbar-right" action="http://www.google.co.kr" id="cse-search-box" target="_blank">
			  <div class="form-group">
			    <input type="hidden" name="cx" value="partner-pub-8163803188491150:6044663021" />
			    <input type="hidden" name="ie" value="UTF-8" />
			    <input type="text" name="q" class="form-control" />
			    <input type="submit" name="sa" value="&#xac80;&#xc0c9;" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.co.kr/coop/cse/brand?form=cse-search-box&amp;lang=ko"></script> -->
			<form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
				<input type="hidden" name="sitesearch" value="https://blog.asamaru.net">
				<div class="form-group">
					<input class="form-control" type="text" name="q" placeholder="Search">
				</div>
			</form>
			
		</div>
	</div>
</nav>


	<div class="container">
		<div class="row">
	<div class="content col-lg-9">
		<div class="sheet post">
			<header>
				<h2>SSH 비밀번호 입력없이 로그인하기</h2>
				<p class="post-meta">
					<!--<span class="glyphicon glyphicon-calendar"></span>--> 2016.01.26.
					
					&nbsp;&nbsp;&nbsp;
					<span>
						<a href="https://blog.asamaru.net/category/linux/"><span class="glyphicon glyphicon-list"></span>&nbsp;linux</a>
					</span>
					<span>
                </span>
				</p>
			</header>
			<hr class="boundary"/>
			<article>

				<!-- Topic of Contents -->
				<!--
								<section class="panel panel-default cToc">
									<div class="panel-heading">
										<h3 class="panel-title">Topic of Contents</h3>
									</div>
									<ul class="list-group">
										<li class="list-group-item toc">
										</li>
									</ul>
								</section>
				-->

				<p>ssh 사용시 매번 비밀번호를 입력하는 것은 귀찮은 일이다. 그럼에도 불구하고 ssh의 기본 기능에 비밀번호를 미리 입력하는 기능을 제공하지 않는 것은 보안 상의 이유 때문일 것이다. 하지만 비밀번호를 입력하는 귀찮음을 해소하는 것 외에도 스케쥴링 처리 스크립트 등에서 사용자의 비밀번호 입력없이 ssh 접속을 해야할 경우가 있다. 이런 경우에 대비해서 ssh에서는 클라이언트의 공개키를 원격 서버에 미리 등록 시켜두는 방식으로 비밀번호 없이 접속할 수 있는 방법을 제공한다. 사실 이 방법이 보안 상으로도 안전한 편이고 등록하는 과정도 크게 복잡하지 않으므로 가장 권장되는 방법이라고 할 수 있다.</p>

<p>그렇다고 이 방법 외에는 대안이 없는 것은 아니다. <code class="highlighter-rouge">expect</code> 명령을 이용해서 비밀번호 입력을 자동화하는 방법과 <a href="http://sourceforge.net/projects/sshpass/">sshpass</a>를 사용하는 방법이 있다. 사실 <a href="http://sourceforge.net/projects/sshpass/">sshpass</a>를 몰랐을 때는 <code class="highlighter-rouge">expect</code>를 주로 사용했는데 <a href="http://sourceforge.net/projects/sshpass/">sshpass</a>를 사용하면 훨씬 쉽게 다양한 일을 할 수 있다.</p>

<p>자.. 이제부터 하나씩 방법을 설명하고자 한다. 아래는 CentOS 기준이며 기타 리눅스에서도 거의 동일한 것으로 알고 있다.</p>

<h3 id="section">1. 공개키 등록 방식</h3>

<p>우선 <code class="highlighter-rouge">~/.ssh/id_rsa.pub</code>에 파일이 존재하는지 확인한다. 없다면 아래와 같이 <code class="highlighter-rouge">ssh-keygen</code>을 사용해서 개인용 개인키/공개키를 생성한다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ssh-keygen -t rsa
</code></pre>
</div>

<p>위 명령을 입력하면 몇가지를 물어보는데 특별한 이유가 없다면 그냥 엔터를 계속 눌러서 완료하면 된다.
이렇게 생성하고나면 개인키는 <code class="highlighter-rouge">~/.ssh/id_rsa</code>로 공개키는 <code class="highlighter-rouge">~/.ssh/id_rsa.pub</code>로 생성된다.</p>

<p>이제는 공개키를 접속하려는 원격 서버에 등록해야 한다.
아래와 같이 직접 해당 서버로 복사하는 방법이 있다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>scp ~/.ssh/id_rsa.pub <span class="o">[</span>user]@[host]:~/.ssh/authorized_keys
</code></pre>
</div>

<p>그런데 이렇게하면 기존 파일이 존재할 경우 덮어쓰게 되므로 권장하지 않는다. 대신 아래와 같이 <code class="highlighter-rouge">ssh-copy-id</code>를 사용하는 것을 권장한다. <code class="highlighter-rouge">ssh-copy-id</code>를 사용하면 원격 서버에 <code class="highlighter-rouge">authorized_keys</code> 파일이 없다면 생성해주고 있다면 공개키를 추가해 준다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ssh-copy-id -i ~/.ssh/id_rsa.pub <span class="o">[</span>user]@[host]
</code></pre>
</div>

<p>여기까지 완료 했다면 비밀번호 없이 ssh 접속이 가능해야 한다.
그런데 간혹 작업을 완료했음에도 불구하고 계속 비밀번호를 물어보는 경우가 있다. 그런 경우는 대부분 원격 서버의 <code class="highlighter-rouge">authorized_keys</code> 파일 퍼미션 문제다. 원격 서버에서 퍼미션을 아래와 같은지 확인하고 맞지 않다면 변경해 준다. 대부분의 경우는 접속 문제가 해결된다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>chmod 700 ~/.ssh/
chmod 600 ~/.ssh/authorized_keys
</code></pre>
</div>

<h3 id="sshpasshttpsourceforgenetprojectssshpass--">2. <a href="http://sourceforge.net/projects/sshpass/">sshpass</a>를 사용하는 방식</h3>

<p><a href="http://sourceforge.net/projects/sshpass/">sshpass</a>는 ssh와는 직접적인 관련이 없는 프로그램으로 별도 설치가 필요하다. 설치되어 있지 않다면 아래와 같이 설치한다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>yum --enablerepo<span class="o">=</span>epel -y install sshpass
</code></pre>
</div>

<p>기본적인 사용은 아래와 같이 할 수 있다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>sshpass -p[password] ssh -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no <span class="o">[</span>user]@[host]
</code></pre>
</div>

<p>위 방식은 서두에서도 이야기 했듯이 비밀번호가 명령 상에 노출되므로 보안상으로는 좋지는 않다. 하지만 필요할 때가 있으니 알아두면 요긴하게 쓰이리라 생각한다. 그리고 <a href="http://sourceforge.net/projects/sshpass/">sshpass</a>는 접속시 비밀번호를 자동 입력해주는 역할 외에 다음과 같은 일도 할 수 있다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># 원격 서버에서 command 실행</span>
sshpass -p[password] ssh -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no <span class="o">[</span>user]@[host] <span class="o">[</span><span class="nb">command</span><span class="o">]</span>
<span class="c"># 원격 서버로 test.txt 파일 복사(scp)</span>
sshpass -p[password] scp -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no test.txt <span class="o">[</span>user]@[host]:~/test.txt
</code></pre>
</div>

<h3 id="expect--">3. expect를 사용하는 방식</h3>

<p><a href="http://sourceforge.net/projects/sshpass/">sshpass</a>를 사용하면 이 방식은 크게 의미가 없다. 하지만 sshpass를 사용할 수 없는 상황이다. expect를 활용해서 다른 곳에 응용할 수 있으니 참고 차원에서 ssh 자동 로그인 스크립트를 남긴다.</p>

<p><strong>sshlogin</strong> 파일로 아래의 내용을 저장하고 실행 권한을 준다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#! /usr/bin/expect</span>
<span class="nb">set </span>idNhost <span class="o">[</span>lrange <span class="nv">$argv</span> 0 0]
<span class="nb">set </span>password <span class="o">[</span>lindex <span class="nv">$argv</span> 1]
spawn ssh <span class="nv">$idNhost</span>
expect -re <span class="s2">"password: "</span>
send <span class="s2">"</span><span class="nv">$password</span><span class="se">\r</span><span class="s2">"</span>
interact
</code></pre>
</div>

<p>사용법은 다음과 같다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>./sshlogin <span class="o">[</span>user]@[host] <span class="s2">"[password]"</span>
</code></pre>
</div>

			</article>
			<hr class="boundary"/>
			<!-- adsense -->
			<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<!-- 블로그 링크형 광고 -->
			<ins class="adsbygoogle"
				 style="display:block"
				 data-ad-client="ca-pub-8163803188491150"
				 data-ad-slot="7708419825"
				 data-ad-format="link"></ins>
			<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
			</script>
			<!-- adsense -->
			<hr class="boundary"/>
		</div>

		<!-- adsense -->
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- 블로그 하단 -->
		<ins class="adsbygoogle"
			 style="display:block; margin-bottom:20px;"
			 data-ad-client="ca-pub-8163803188491150"
			 data-ad-slot="7841851420"
			 data-ad-format="auto"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
		<!-- adsense -->

		<div class="pad-min"></div>
		<div id="post-comment" class="sheet post">
			<div id="disqus_thread"></div>
		</div>
	</div>
	<div class="content-navigation col-lg-3">
		<!-- I made it -->
		<section class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">I made it</h3>
			</div>
			<ul class="list-group">
				<li class="list-group-item"><a href="http://sprite.asamaru.net/" target="_blank">Sprite CSS/Image</a></li>
				<li class="list-group-item"><a href="http://loan.asamaru.net/" target="_blank">대출이자계산기</a></li>
				<li class="list-group-item"><a href="http://bookmarklet.asamaru.net/" target="_blank">북마클릿 생성기</a></li>
			</ul>
		</section>

		<!-- Categories -->
		
		
		<section class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">Categories</h3>
			</div>
			<ul class="list-group">
				
				<li class="list-group-item"><a href="/category/thinking/">Thinking <span class="badge">3</span></a></li>
				
				<li class="list-group-item"><a href="/category/osx/">Osx <span class="badge">7</span></a></li>
				
				<li class="list-group-item"><a href="/category/programming/">Programming <span class="badge">1</span></a></li>
				
				<li class="list-group-item"><a href="/category/css/">Css <span class="badge">3</span></a></li>
				
				<li class="list-group-item"><a href="/category/js/">Js <span class="badge">10</span></a></li>
				
				<li class="list-group-item"><a href="/category/android/">Android <span class="badge">53</span></a></li>
				
				<li class="list-group-item"><a href="/category/octopress/">Octopress <span class="badge">8</span></a></li>
				
				<li class="list-group-item"><a href="/category/ios/">Ios <span class="badge">18</span></a></li>
				
				<li class="list-group-item"><a href="/category/php/">Php <span class="badge">23</span></a></li>
				
				<li class="list-group-item"><a href="/category/java/">Java <span class="badge">5</span></a></li>
				
				<li class="list-group-item"><a href="/category/db/">Db <span class="badge">6</span></a></li>
				
				<li class="list-group-item"><a href="/category/html/">Html <span class="badge">2</span></a></li>
				
				<li class="list-group-item"><a href="/category/git/">Git <span class="badge">7</span></a></li>
				
				<li class="list-group-item"><a href="/category/blog/">Blog <span class="badge">1</span></a></li>
				
				<li class="list-group-item"><a href="/category/tip/">Tip <span class="badge">13</span></a></li>
				
				<li class="list-group-item"><a href="/category/linux/">Linux <span class="badge">27</span></a></li>
				
				<li class="list-group-item"><a href="/category/swift/">Swift <span class="badge">6</span></a></li>
				
				<li class="list-group-item"><a href="/category/iOS/">Ios <span class="badge">2</span></a></li>
				
				<li class="list-group-item"><a href="/category/vagrant/">Vagrant <span class="badge">5</span></a></li>
				
				<li class="list-group-item"><a href="/category/jekyll/">Jekyll <span class="badge">2</span></a></li>
				
				<li class="list-group-item"><a href="/category/flash/">Flash <span class="badge">1</span></a></li>
				
			</ul>
		</section>
		
		

		<!-- Tags -->
		
		
		

		<!-- adsense -->
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- 블로그 우측 -->
		<ins class="adsbygoogle"
			 style="display:block; margin-bottom:20px;"
			 data-ad-client="ca-pub-8163803188491150"
			 data-ad-slot="1934918622"
			 data-ad-format="auto"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
		<!-- adsense -->

		<!-- Related -->
		

		

		
		<section class="panel panel-default dRelatedPosts">
			<div class="panel-heading">
				<h3 class="panel-title">Related</h3>
			</div>
			<ul class="list-group">
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/11/15/linux-find-empty-directory-and-delete/">리눅스에서 모든 빈 디렉토리 찾기 / 지우기</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/10/26/nginx-504-error/">nginx 504 Gateway Time-out 오류</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/04/26/efficiently-delete-large-directory-containing-thousands-of-files/">linux에서 대량의 파일을 보다 빠르게 지우기</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/04/14/how-to-chmod-all-directories-or-files/">chmod로 권한 변경시 디렉토리(또는 파일)만 적용하기</a></li>
				
				<li class="list-group-item"><a href="https://blog.asamaru.net/2016/04/07/how-to-protect-ssh-with-fail2ban-on-centos-6-7/">SSH 무작위 로그인 시도 막기(With Fail2Ban on CentOS 6/7 + selinux)</a></li>
				
			</ul>
		</section>
		

		<section class="panel panel-default">
			<style>
				#google_translate_country { text-align:center; padding-top:5px; }
				#google_translate_element > div { text-align:center; padding:5px 0; }
				#google_translate_element > div > div { display:inline-block; *display:inline; *zoom:1; margin-right:10px; }
			</style>
			<div id="google_translate_country">
				<a href="#googtrans(ko|en)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/English.gif?w=660" alt="English"/></a>
				<!-- <a href="#googtrans(ko|ko)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Korean.gif?w=660" alt="Korean"/></a> -->
				<a href="#googtrans(ko|zh-CN)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Chinese.gif?w=660" alt="Chinese"/></a>
				<a href="#googtrans(ko|ja)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Japanese.gif?w=660" alt="Japanese"/></a>
				<a href="#googtrans(ko|fr)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/French.gif?w=660" alt="French"/></a>
				<a href="#googtrans(ko|de)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/German.gif?w=660" alt="German"/></a>
				<a href="#googtrans(ko|it)" onclick="setTimeout(function() { document.location.reload(); });"><img src="/static/img/lang/Italian.gif?w=660" alt="Italian"/></a>
			</div>
			<div id="google_translate_element"></div>
			<script type="text/javascript">
				function googleTranslateElementInit() {
					new google.translate.TranslateElement({pageLanguage: 'ko'}, 'google_translate_element');
				}
			</script>
			<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
		</section>
	</div>
</div>


		
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'asamaru7'; // required: replace example with your forum shortname
			// var disqus_developer = 1; // Comment out when the site is live
			var disqus_identifier = "/2016/01/26/ssh-login-without-password/";

			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var dsq = document.createElement('script');
				dsq.type = 'text/javascript';
				dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		
	</div>

	<div class="page-scrollTop" data-toggle="tooltip" data-placement="top" title="Top">
		<a href="javascript:void(0);">
			<div class="arrow"></div>
			<div class="stick"></div>
		</a>
	</div>
</div>

<footer class="footnote footnote-tiffany">
	<div class="container">
		<a class="foot-item" href="mailto:asamaru@asamaru.net" target="_blank"><img src="/static/img/bottom-email.png" alt="Email"></a>
		<a class="foot-item" href="https://github.com/asamaru7" target="_blank"><img src="/static/img/bottom-github.png" alt="Github"></a>
		<a class="foot-item" href="https://blog.asamaru.net/atom.xml" target="_blank"><img src="/static/img/bottom-rss.png" alt="RSS"></a>
		&nbsp;
		<a href="https://blog.asamaru.net"><span class="word-keep">&copy; 유영재</span></a>
	</div>
</footer>


<div class="scriptHub">
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://blog.asamaru.net/static/js/script.js"></script>

	
	<script type="text/javascript" src="https://blog.asamaru.net/static/js/post.js"></script>
	
	
</div>



</body>
</html>
