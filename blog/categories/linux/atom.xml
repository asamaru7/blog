<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: linux | 이 세상에 하나는 남기고 가자]]></title>
  <link href="http://blog.asamaru.net/blog/categories/linux/atom.xml" rel="self"/>
  <link href="http://blog.asamaru.net/"/>
  <updated>2015-10-13T17:18:07+09:00</updated>
  <id>http://blog.asamaru.net/</id>
  <author>
    <name><![CDATA[유영재]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[NIC I/F 번호(eth*)를 변경]]></title>
    <link href="http://blog.asamaru.net/2015/10/08/change-centos-6-nic-i-slash-f-number-eth-star/"/>
    <updated>2015-10-08T12:06:26+09:00</updated>
    <id>http://blog.asamaru.net/2015/10/08/change-centos-6-nic-i-slash-f-number-eth-star</id>
    <content type="html"><![CDATA[<p>NIC 교체 및 추가 시 MAC 정보와 H/W 정보가 변경되어 /etc/sysconfig/network-script/ifcfg-ethX 파일이 증가한다.
이때 기존의 I/F 번호를 변경하려면 /etc/udev/rules.d/70-persistent-net.rules의 기존 정보 삭제 및 신규 I/F의 NAME을 변경하고 Rebooting 하면 된다.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CentOS autofs]]></title>
    <link href="http://blog.asamaru.net/2015/10/08/centos-autofs/"/>
    <updated>2015-10-08T12:04:05+09:00</updated>
    <id>http://blog.asamaru.net/2015/10/08/centos-autofs</id>
    <content type="html"><![CDATA[<h2 id="설치">설치</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">yum install -y autofs
</code></pre></div>
<h2 id="설정">설정</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># 서버 부팅시 자동 시작</span>
/sbin/chkconfig --add autofs
/sbin/chkconfig --level <span class="m">35</span> autofs on
</code></pre></div>
<h2 id="mount-설정">mount 설정</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">vi /etc/auto.master

/home/nfsusers   /etc/auto.users --timeout 60

vi /etc/auto.users
yyj -rw,vers<span class="o">=</span>3,udp,nolock   192.168.11.99:/czdev/vagrant/work/web

service autofs restart
</code></pre></div>
<h2 id="관리">관리</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># 데몬 재시작</span>
service autofs restart

<span class="c"># 상태 확인</span>
service autofs status

<span class="c"># 설정 다시 일기</span>
service autofs reload
</code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># 동작 로그 보기</span>
service autofs stop
automount -f -v
</code></pre></div>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[리눅스 명령어 모음(Centos 6)]]></title>
    <link href="http://blog.asamaru.net/2015/10/08/useful-commands-for-linux/"/>
    <updated>2015-10-08T11:44:32+09:00</updated>
    <id>http://blog.asamaru.net/2015/10/08/useful-commands-for-linux</id>
    <content type="html"><![CDATA[<p>아래의 내용은 개인적으로 간혹 사용이 필요한 내용을 기록해 두기 위한 것으로 잘못된 정보일 수 있으니 참고만 하기 바란다.</p>

<h3 id="시스템-로그-삭제">시스템 로그 삭제</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/init.d/rsyslog restart
</code></pre></div>
<h3 id="sl-인증서-apache-시작시-비밀번호-입력-제거">sl 인증서 + apache 시작시 비밀번호 입력 제거</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">openssl rsa -in key.pem -out key.nopw.pem
</code></pre></div>
<h3 id="ssh-접속자-강제-로그아웃">ssh 접속자 강제 로그아웃</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># 602 : userid</span>
pkill -KILL -u 602
</code></pre></div>
<h3 id="bash-script에서-실행경로-구하기">bash script에서 실행경로 구하기</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> <span class="k">${</span><span class="nv">0</span><span class="p">%/*</span><span class="k">}</span> 2&gt;/dev/null
<span class="nb">echo</span> <span class="nv">$PWD</span>/<span class="k">${</span><span class="nv">0</span><span class="p">##*/</span><span class="k">}</span>
</code></pre></div>
<h3 id="서버-네트워크-상태-확인">서버 네트워크 상태 확인</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">netstat -an<span class="p">|</span>grep <span class="s2">&quot;:80&quot;</span><span class="p">|</span>awk <span class="s1">&#39;/tcp/ {print $6}&#39;</span><span class="p">|</span>sort -nr<span class="p">|</span> uniq -c
</code></pre></div>
<h3 id="아파치-동시접속자-수-확인">아파치 동시접속자 수 확인</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">netstat -anp <span class="p">|</span> grep :80 <span class="p">|</span> grep ESTAB <span class="p">|</span> wc -l
</code></pre></div>
<h3 id="권한-파일-찾기-바꾸기">권한 파일 찾기 / 바꾸기</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># root 권한 파일 찾기</span>
find . -uid 0

<span class="c"># chown 특정 사용자만 변경</span>
chown web.usergroup * -R --from<span class="o">=</span>root.root
chown --from<span class="o">=</span><span class="m">511</span> -R web account/
</code></pre></div>
<h3 id="포트-강제로-죽이기">포트 강제로 죽이기</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo fuser -k -n tcp 444
</code></pre></div>
<h3 id="실행-결과-숨기기-stdout-stderr">실행 결과 숨기기(stdout, stderr)</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">명력어 &gt; /dev/null 2&gt;<span class="p">&amp;</span>1
</code></pre></div>
<h3 id="검색된-파일만-vi-열기">검색된 파일만 vi 열기</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">vi -p <span class="k">$(</span>find .<span class="p">|</span>grep ModuleLink<span class="p">|</span>grep -v <span class="s1">&#39;.svn&#39;</span><span class="p">|</span>grep -v CZFramework<span class="k">)</span>
</code></pre></div>
<h3 id="내용-일괄변환">내용 일괄변환</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">find . -type f -name *.php -exec perl -pi -e <span class="s1">&#39;s|\\CZ\\CZFramework|\\CZF|g&#39;</span> <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div>
<h3 id="ssh-비밀번호-없이-접속">ssh 비밀번호 없이 접속</h3>

<h4 id="local">local</h4>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">ssh-keygen -t rsa
<span class="c"># scp /root/.ssh/id_rsa.pub root@[ip]:/root/.ssh/authorized_keys</span>
ssh-copy-id -i ~/.ssh/id_rsa.pub admin@<span class="o">[</span>ip<span class="o">]</span>
</code></pre></div>
<h4 id="대상-서버-호스트-의-퍼미션">대상 서버(호스트)의 퍼미션</h4>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="m">750</span> /home/admin/
<span class="m">700</span> /home/admin/.ssh/
<span class="m">600</span> /home/admin/.ssh/authorized_keys
</code></pre></div>
<h3 id="배드블럭-검사">배드블럭 검사</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">badblocks -v /dev/sda1
</code></pre></div>
<h3 id="프로세스-실행경로-확인">프로세스 실행경로 확인</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># 프로세스 정보</span>
ps ef
ps aux

<span class="c"># 프로세스 트리보기</span>
pstree -aph

<span class="c">#프로세스 상세보기</span>
lsof -P
</code></pre></div>
<h3 id="아파치-모든-페이지-요청시-동일페이지-노출">아파치 :  모든 페이지 요청시 동일페이지 노출</h3>
<div class="highlight"><pre><code class="language-apacheconf" data-lang="apacheconf"><span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="nb">RewriteRule</span> ^(.*)$ <span class="sx">/target/index.html</span>
</code></pre></div>
<h2 id="mysql-사용자-관리">Mysql 사용자 관리</h2>

<h4 id="패턴">패턴</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="err">디비명</span><span class="p">.</span><span class="err">테이블명</span> <span class="k">to</span> <span class="err">사용자</span><span class="o">@</span><span class="s1">&#39;접속지 주소&#39;</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">&#39;암호&#39;</span> <span class="p">(</span><span class="k">with</span> <span class="k">grant</span> <span class="k">option</span><span class="p">);</span>
</code></pre></div>
<h4 id="권한-생성">권한 생성</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="c1"># 원격지에서 root로 접속하는 경우</span>
<span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">to</span> <span class="n">root</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">&#39;암호&#39;</span> <span class="k">with</span> <span class="k">grant</span> <span class="k">option</span><span class="p">;</span>

<span class="c1"># &#39;사용자&#39;가 &#39;암호&#39;으로 모든 컴퓨터에서 모든 디비와 테이블에 접속하도록 허용</span>
<span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">to</span> <span class="err">사용자</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">&#39;암호&#39;</span><span class="p">;</span>

<span class="c1"># &#39;사용자&#39;가 &#39;암호&#39;으로 localhost 에서 db1 디비의 table1에 접속하도록 허용</span>
<span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="n">root</span><span class="p">.</span><span class="n">db1</span> <span class="k">to</span> <span class="err">사용자</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">&#39;암호&#39;</span><span class="p">;</span>

<span class="c1"># &#39;사용자&#39;가 &#39;암호&#39;으로 111.222.333.444 에서 db1 디비의 모든 테이블에 접속하도록 허용</span>
<span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="n">root</span><span class="p">.</span><span class="o">*</span> <span class="k">to</span> <span class="err">사용자</span><span class="o">@</span><span class="s1">&#39;111.222.333.444&#39;</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">&#39;암호&#39;</span><span class="p">;</span>

<span class="c1"># &#39;사용자&#39;가 &#39;암호&#39;으로 111.222.333.0/24 에서 모든 디비와 테이블에 접속하도록 허용</span>
<span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">to</span> <span class="err">사용자</span> <span class="o">@</span><span class="s1">&#39;111.222.333.%&#39;</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">&#39;암호&#39;</span><span class="p">;</span>
</code></pre></div>
<h4 id="권한-제거">권한 제거</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">revoke</span> <span class="k">all</span> <span class="k">on</span> <span class="err">디비명</span><span class="p">.</span><span class="err">테이블명</span> <span class="k">from</span> <span class="err">사용자</span><span class="p">;</span>
</code></pre></div>
<h4 id="권한-적용">권한 적용</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="c1"># 모든 명령 후에 항상 아래 명령을 실행해야 실제로 적용된다.</span>
<span class="n">flush</span> <span class="n">privileges</span><span class="p">;</span>
</code></pre></div>
<h4 id="connection-상태-확인하기">Connection 상태 확인하기</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">SHOW</span> <span class="n">FULL</span> <span class="n">PROCESSLIST</span><span class="p">;</span>
</code></pre></div>
<h4 id="connection-수-확인하기">Connection 수 확인하기</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">SHOW</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">&#39;Threads_connected&#39;</span><span class="p">;</span>
</code></pre></div>
<h4 id="동작중인-connection-수-확인하기">동작중인 Connection 수 확인하기</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">SHOW</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">&#39;Threads_running&#39;</span><span class="p">;</span>
</code></pre></div>
<h4 id="connection-상태-확인하기">Connection 상태 확인하기</h4>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">SHOW</span> <span class="n">FULL</span> <span class="n">PROCESSLIST</span><span class="p">;</span>
</code></pre></div>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[리눅스에서 swap 메모리 초기화]]></title>
    <link href="http://blog.asamaru.net/2015/10/02/linux-how-to-clear-memory-swap/"/>
    <updated>2015-10-02T08:31:46+09:00</updated>
    <id>http://blog.asamaru.net/2015/10/02/linux-how-to-clear-memory-swap</id>
    <content type="html"><![CDATA[<p>리눅스에서 swap 메모리를 초기화하는 것은 아주 간단하다.
일시적 메모리 사용의 증가로 swap을 사용하게될 경우 메모리에 여유가 생겨도 swap 메모리는 자동으로 초기화되지 않는다. 이것을 수동으로 초기화하려면 아래의 명령을 입력하면 된다. 당연히 root 권한에서 실행해야 한다.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">swapoff -a <span class="o">&amp;&amp;</span> swapon -a
</code></pre></div>
<p>swapoff 처리에 시간이 조금 오래 걸릴 수 있는데 서버가 멈춘 것은 아니므로 걱정하지 않아도 된다. swap 메모리에서 필요한 부분을 물리 메모리로 옮기는 처리중인 것이다.</p>
]]></content>
  </entry>
  
</feed>
