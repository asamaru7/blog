<!DOCTYPE html>
<html>

<head>
	<title>이 세상에 하나는 남기고 가자</title>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<meta name="author" content="유영재">
	<meta name="keywords" content="이 세상에 하나는 남기고 가자"/>
	<meta name="description" content="세상에 필요한 소스코드 한줄 남기고 가자.
"/>

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- http://opengraphprotocol.org/ -->
	<meta name="twitter:card" content="summary_large_image">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://blog.asamaru.net/posts/63/">
	<meta property="og:title" content="이 세상에 하나는 남기고 가자">
	<meta property="og:description" content="세상에 필요한 소스코드 한줄 남기고 가자.
">

	<link rel="canonical" href="https://blog.asamaru.net/posts/63/"/>
	<link rel="shortcut icon" type="image/x-icon" media="screen" href="https://blog.asamaru.net/favicon.ico"/>
	<link rel="alternate" type="application/rss+xml" title="이 세상에 하나는 남기고 가자" href="https://blog.asamaru.net/atom.xml"/>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/style.css"/>
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/highlight.css"/>

	
	
	<link rel="stylesheet" type="text/css" href="https://blog.asamaru.net/static/css/article-list.css"/>
	

	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
					(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-65749108-2', 'auto');
		ga('send', 'pageview');

	</script>
</head>


<body>
<div class="main">

	<nav class="navbar navbar-default" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">이 세상에 하나는 남기고 가자</a>
		</div>

		<div class="navbar-collapse collapse">
			
			<ul class="nav navbar-nav">
				<li class="active">
				<a rel="index" href="/">Blog</a>
				</li>
				<li >
				<a href="/archives/">Archives</a>
				</li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a class="subscribe-rss" href="https://blog.asamaru.net/atom.xml" title="subscribe via RSS">
						<span class="visible-xs">RSS</span>
						<img class="hidden-xs" src="/static/img/rss.png" alt="RSS">
					</a>
				</li>
			</ul>
			
			<!-- <form class="navbar-form navbar-right" action="http://www.google.co.kr" id="cse-search-box" target="_blank">
			  <div class="form-group">
			    <input type="hidden" name="cx" value="partner-pub-8163803188491150:6044663021" />
			    <input type="hidden" name="ie" value="UTF-8" />
			    <input type="text" name="q" class="form-control" />
			    <input type="submit" name="sa" value="&#xac80;&#xc0c9;" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.co.kr/coop/cse/brand?form=cse-search-box&amp;lang=ko"></script> -->
			<form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
				<input type="hidden" name="sitesearch" value="https://blog.asamaru.net">
				<div class="form-group">
					<input class="form-control" type="text" name="q" placeholder="Search">
				</div>
			</form>
			
		</div>
	</div>
</nav>


	<div class="container">
		<div class="row index">
	<div class="content col-lg-9">
		<div>
			<section class="category-slice" post-cate="All">
				
				<article>
					<div class="module">
						<header>
							<a class="title" href="https://blog.asamaru.net/2015/12/23/moving-from-octopress-to-jekyll/">
								Octopress 2에서 Jekyll로 전환
							</a>
							<p class="post-meta">
								<a href="https://blog.asamaru.net/2015/12/23/moving-from-octopress-to-jekyll/">2015.12.23.</span></a>
							</p>
						</header>
						<p>
							<p>최근 이틀동안 현재 운영중인 블로그에서 사용중인 옥토프레스를 걷어내고 순수 <a href="https://jekyllrb.com/">Jekyll</a>로 전환하는 작업을 했다. 사실 처음엔 지금 사용중인 옥토프레스를 3버전으로 버전업 하려고 했다. 그래서 <a href="http://samwize.com/2015/09/30/migrating-octopress-2-to-octopress-3/">Migrating Octopress 2 to Octopress 3</a>를 따라 전환을 시도했다. 이 글에서도 나와 있는 것처럼 옥토프레스 제작자가 <a href="http://octopress.org/2015/01/15/octopress-3.0-is-coming/">Octopress 3.0 Is Coming</a>이라고만 해두고 정식 릴리즈를 하지 않아 기다림에 지쳐 작업을 시작했다(이때까지만 하더라도 일이 간단하리라 생각했다).</p>

<p>아래의 글은 체계적인 설치 안내서 보다는 전환 경험담에 가깝다. 아래의 과정을 따라 설치하면 동일하게 안될 확률이 높으므로 참고만 하길 바란다. 사실 처음엔 잘 정리해 두려고 했는데 워낙에 이리저리 시도를 많이 하면서 정리하는 것을 포기했다.</p>

<p><a href="https://jekyllrb.com/">Jekyll</a> 전환에 앞서 octopress 버전업 시도 과정부터 이야기하려고 한다.</p>

<p><a href="https://github.com/octopress/octopress">Octopress 3 - Github</a>에 가면 최신 옥토프레스를 확인할 수 있다. 현재 시점을 기준으로 3.0.11이 최신이다. 정식 릴리즈를 공식적으로 출시하지 않았지만 개발을 나름 활발히 진행중이다. 나중에 버전업을 진행해 보니 왜 정식 릴리즈를 하지 못하고 있는지 알 것도 같다. <a href="https://jekyllrb.com/">Jekyll</a> 기반으로 여러가지 플러그인을 사용하고 템플릿의 제작도 프로그램 제작에 준할 정도로 커스텀되는 상황이다보니 체계적인 마이그레이션 방법을 제시하기 어려운 것 같다.</p>

<p><a href="http://samwize.com/2015/09/30/migrating-octopress-2-to-octopress-3/">Migrating Octopress 2 to Octopress 3</a>에 나름 잘 설명되어 있기는하나 나의 경우엔 그대로 적용되지 않았다(특별한 플러그인 다수 사용하지도 않았는데). 결국은 여러가지 시도 끝에 남은 거라곤 옥토프레스 3.0.11이 설치되었다는 것 밖에 없다(사실 이건 간단히 설치가 되므로 대부분의 시간을 허비한 것이다).</p>

<p>이러한 이유로 순수 <a href="https://jekyllrb.com/">Jekyll</a>로 전환을 시작하게 되었다. 사실 이 과정도 옥토프레스를 버전업하는 것과 같이 새로운 블로그를 생성하고 주요 설정을 이전하는 것이다.
옥토프레스는 원래 Jekyll을 기반으로 확장된 것이라 전환이 간단할 것이라고 생각했다. 이것 또한 착각이었다. 이 과정에서도 여러가지 실패기가 있지만 다 나열하기도 힘들다. 이후부터는 설치 과정을 간략히 요약하려고 한다.</p>

<hr />

<p>아래는 Jekyll을 설치하기 위한 <strong>Gemfile</strong> 의 내용이다. 거의 필수에 가까운 플러그인만으로 구성했다.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'jekyll'</span><span class="p">,</span> <span class="s1">'= 3.0.1'</span>
<span class="n">gem</span> <span class="s1">'jekyll-paginate'</span>
<span class="n">gem</span> <span class="s1">'jekyll-archives'</span>
<span class="n">gem</span> <span class="s1">'jekyll-sitemap'</span>
<span class="n">gem</span> <span class="s1">'jekyll-feed'</span>
<span class="n">gem</span> <span class="s1">'pygments.rb'</span>
</code></pre>
</div>

<p><strong>Gemfile</strong> 을 사용한 설치는 아래와 같이 할 수 있다. 단, ruby 버전 2.1 이상을 요구할 수 있는데 그때는 rvm을 사용해 설치하면 된다.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo gem install bundler
<span class="gp">$ </span>bundle install
</code></pre>
</div>

<p>다음은 <a href="https://jekyllrb.com/">Jekyll</a>에서 가장 중요한 <strong>_config.yml</strong> 파일의 내용이다.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">gems</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">jekyll-paginate</span>
  <span class="pi">-</span> <span class="s">jekyll-archives</span>
  <span class="pi">-</span> <span class="s">jekyll-sitemap</span>
  <span class="pi">-</span> <span class="s">jekyll-feed</span>
  <span class="pi">-</span> <span class="s">pygments.rb</span>

<span class="s">exclude</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">.idea"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">.git"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">README.md"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">Gemfile"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">Gemfile.lock"</span><span class="pi">]</span>

<span class="s">url</span><span class="pi">:</span> <span class="s">http://blog.asamaru.net</span>
<span class="s">title</span><span class="pi">:</span> <span class="s">이 세상에 하나는 남기고 가자</span>
<span class="s">subtitle</span><span class="pi">:</span> <span class="s">내가 할 수 있는 모든 것을...</span>
<span class="s">author</span><span class="pi">:</span> <span class="s">유영재</span>
<span class="s">simple_search</span><span class="pi">:</span> <span class="s">https://www.google.com/search</span>
<span class="s">description</span><span class="pi">:</span> <span class="pi">&gt;</span> <span class="c1"># this means to ignore newlines until "baseurl:"</span>
  <span class="no">세상에 필요한 소스코드 한줄 남기고 가자.</span>

<span class="s">email</span><span class="pi">:</span> <span class="s">asamaru@asamaru.net</span>
<span class="s">baseurl</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># the subpath of your site, e.g. /blog/</span>

<span class="s">permalink</span><span class="pi">:</span> <span class="s">/:year/:month/:day/:title/</span>

<span class="s">markdown</span><span class="pi">:</span> <span class="s">KramdownPygments</span>
<span class="s">markdown_ext</span><span class="pi">:</span> <span class="s">markdown,mkd,mkdn,md</span>
<span class="s">textile_ext</span><span class="pi">:</span> <span class="s">textile</span>
<span class="s">kramdown</span><span class="pi">:</span>
  <span class="s">input</span><span class="pi">:</span> <span class="s">GFM</span>
  <span class="s">auto_ids</span><span class="pi">:</span> <span class="s">true</span>
  <span class="s">footnote_nr</span><span class="pi">:</span> <span class="s">1</span>
  <span class="s">entity_output</span><span class="pi">:</span> <span class="s">as_char</span>
  <span class="s">toc_levels</span><span class="pi">:</span> <span class="s">1..6</span>
  <span class="s">smart_quotes</span><span class="pi">:</span> <span class="s">lsquo,rsquo,ldquo,rdquo</span>

<span class="s">paginate</span><span class="pi">:</span> <span class="s">1</span>
<span class="s">paginate_path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">posts/:num"</span>
<span class="s">recent_posts</span><span class="pi">:</span> <span class="s">5</span>
<span class="s">excerpt_link</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Read</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">&amp;rarr;"</span>
<span class="s">excerpt_separator</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;!--more--&gt;"</span>

<span class="s">titlecase</span><span class="pi">:</span> <span class="s">false</span>

<span class="c1"># Disqus Comments</span>
<span class="s">disqus_short_name</span><span class="pi">:</span> <span class="s">asamaru7</span>

<span class="c1"># Google Analytics</span>
<span class="s">google_analytics_tracking_id</span><span class="pi">:</span> <span class="s">UA-65749108-2</span>

<span class="s">github_username</span><span class="pi">:</span> <span class="s">asamaru7</span>

<span class="s">feed</span><span class="pi">:</span>
  <span class="s">path</span><span class="pi">:</span> <span class="s">atom.xml</span>

<span class="c1"># archives 생성</span>
<span class="s">jekyll-archives</span><span class="pi">:</span>
  <span class="s">enabled</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">categories</span>
    <span class="pi">-</span> <span class="s">year</span>
    <span class="pi">-</span> <span class="s">month</span>
    <span class="pi">-</span> <span class="s">day</span>
    <span class="pi">-</span> <span class="s">tags</span>
  <span class="s">layouts</span><span class="pi">:</span>
    <span class="s">year</span><span class="pi">:</span> <span class="s">archive-year</span>
    <span class="s">month</span><span class="pi">:</span> <span class="s">archive-month</span>
    <span class="s">day</span><span class="pi">:</span> <span class="s">archive-day</span>
    <span class="s">tag</span><span class="pi">:</span> <span class="s">archive-tag</span>
    <span class="s">category</span><span class="pi">:</span> <span class="s">archive-tag</span>
  <span class="s">permalinks</span><span class="pi">:</span>
    <span class="s">year</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/:year/'</span>
    <span class="s">month</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/:year/:month/'</span>
    <span class="s">day</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/:year/:month/:day/'</span>
    <span class="s">tag</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/tag/:name/'</span>
    <span class="s">category</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/category/:name/'</span>
</code></pre>
</div>

<p>하나씩 설명하자니 너무 많다. 다만 그리 어려운 설정들이 아니므로 보면 이해할 것으로 본다.</p>

<p>마지막으로 한가지. <a href="https://github.com/mvdbos/kramdown-with-pygments">Kramdown with Pygments</a>라는 플러그인을 사용했다. Jekyll에서 kramdown을 사용하면서 Pygments를 함께 사용(코드 하이라이팅)하기 위한 플러그인이다. 그런데 몇가지 문제가 있어 아래와 같이 변형해서 사용하고 있다. 덤으로 옥토프레스에서 코드 블럭에 사용되던 문법도 호환되게 변경했으나 마지막에 문제에 걸렸다. kramdown에서 그 문법을 정상적으로 인식하지 못했다. 코드에 빈 줄바꿈이 포함되면 정상적으로 인식하지 못한다. 따라서 이 플러그인이 동작하기 이전에 발생되는 문제로 여기서는 아직 처리하지 못했다. 시간을 들여 분석해보면 처리 방법이 있을수도 있지만 일단 두기로 했다. 중요한 문제는 아니므로(게다가 내가 ruby를 모른다. 이 작업도 기본 문법 몇가지만 공부해서 처리한 것이라 깊이있는 수정은 어렵다).</p>

<p><strong>kramdown_pygments.rb</strong></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="c1"># We define the an additional option for the kramdown parser to look for</span>
<span class="k">module</span> <span class="nn">Kramdown</span>
  <span class="k">module</span> <span class="nn">Options</span>
      <span class="n">define</span><span class="p">(</span><span class="ss">:kramdown_default_lang</span><span class="p">,</span> <span class="no">Symbol</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="p">)</span><span class="sh">
Sets the default language for highlighting code blocks

If no language is set for a code block, the default language is used
instead. The value has to be one of the languages supported by pygments
or nil if no default language should be used.

Default: nil
Used by: PygmentsHtml converter
</span><span class="no">EOF</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># This class is a plugin for kramdown, to make it use pygments instead of coderay</span>
<span class="c1"># It has nothing to do with Jekyll, it is simply used by the custom converter below</span>
<span class="k">module</span> <span class="nn">Kramdown</span>
  <span class="k">module</span> <span class="nn">Converter</span>
    <span class="c1">#AllOptions = /([^\s]+)\s+(.+?)\s+(https?:\/\/\S+|\/\S+)\s*(.+)?\n/i</span>
    <span class="c1">#LangCaption = /([^\s]+)\s*(.+)?\n/i</span>
    <span class="no">AllOptions</span> <span class="o">=</span> <span class="sr">/([a-z0-9]+)[[:blank:]]+(.+?)[[:blank:]]+(https?:\/\/\S+|\/\S+)[[:blank:]]*([^\n]+)?\n/i</span>
    <span class="no">LangCaption</span> <span class="o">=</span> <span class="sr">/([a-z0-9]+)[[:blank:]]*([^\n]+)?\n/i</span>

    <span class="k">class</span> <span class="nc">PygmentsHtml</span> <span class="o">&lt;</span> <span class="no">Html</span>

      <span class="k">begin</span>
        <span class="nb">require</span> <span class="s1">'pygments'</span>
      <span class="k">rescue</span> <span class="no">LoadError</span>
        <span class="no">STDERR</span><span class="p">.</span><span class="nf">puts</span> <span class="s1">'You are missing a library required for syntax highlighting. Please run:'</span>
        <span class="no">STDERR</span><span class="p">.</span><span class="nf">puts</span> <span class="s1">'  $ [sudo] gem install pygments'</span>
        <span class="k">raise</span> <span class="no">FatalException</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"Missing dependency: Pygments"</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">convert_codeblock</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
        <span class="n">codeProc</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">convert_codespan</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
        <span class="n">codeProc</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">codeProc</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">isSapn</span><span class="p">)</span>
        <span class="kp">attr</span> <span class="o">=</span> <span class="n">el</span><span class="p">.</span><span class="nf">attr</span><span class="p">.</span><span class="nf">dup</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="n">extract_code_language!</span><span class="p">(</span><span class="kp">attr</span><span class="p">)</span> <span class="o">||</span> <span class="vi">@options</span><span class="p">[</span><span class="ss">:kramdown_default_lang</span><span class="p">]</span>
        <span class="c1"># STDERR.puts "lang #{el.value}"</span>

        <span class="n">codeStr</span> <span class="o">=</span> <span class="n">el</span><span class="p">.</span><span class="nf">value</span>
        <span class="c1"># octopress code 형식 지원</span>
        <span class="n">caption</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="k">if</span> <span class="n">isSapn</span>
          <span class="k">if</span> <span class="n">codeStr</span> <span class="o">=~</span> <span class="no">AllOptions</span> <span class="n">or</span> <span class="n">codeStr</span> <span class="o">=~</span> <span class="no">LangCaption</span>
            <span class="n">acceptLang</span> <span class="o">=</span> <span class="no">Pygments</span><span class="o">::</span><span class="no">Lexer</span><span class="p">.</span><span class="nf">find_by_alias</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="vg">$1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">acceptLang</span> <span class="o">!=</span> <span class="kp">nil</span>
              <span class="c1"># STDERR.puts "lang [#{$1}] [#{$2}]"</span>
              <span class="n">isSapn</span> <span class="o">=</span> <span class="kp">false</span>
              <span class="n">lang</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="vg">$1</span><span class="si">}</span><span class="s2">"</span>

              <span class="k">if</span> <span class="n">codeStr</span> <span class="o">=~</span> <span class="no">AllOptions</span>
                <span class="c1"># STDERR.puts "lang all"</span>
                <span class="c1"># fn = "#{$2}".gsub(/\s+/, "")</span>
                <span class="n">caption</span> <span class="o">=</span> <span class="s2">"&lt;figcaption&gt;&lt;span&gt;</span><span class="si">#{</span><span class="vg">$2</span><span class="si">}</span><span class="s2">&lt;/span&gt;&lt;a href='</span><span class="si">#{</span><span class="vg">$3</span><span class="si">}</span><span class="s2">'&gt;</span><span class="si">#{</span><span class="vg">$4</span> <span class="o">||</span> <span class="s1">'link'</span><span class="si">}</span><span class="s2">&lt;/a&gt;&lt;/figcaption&gt;"</span>
              <span class="k">end</span>
              <span class="k">if</span> <span class="n">caption</span> <span class="o">==</span> <span class="s2">""</span> <span class="n">and</span> <span class="n">codeStr</span> <span class="o">=~</span> <span class="no">LangCaption</span>
                <span class="c1"># STDERR.puts "lang lang"</span>
                <span class="n">caption</span> <span class="o">=</span> <span class="s2">"&lt;figcaption&gt;&lt;span&gt;</span><span class="si">#{</span><span class="vg">$2</span><span class="si">}</span><span class="s2">&lt;/span&gt;&lt;/figcaption&gt;"</span>
              <span class="k">end</span>
              <span class="k">if</span> <span class="n">caption</span> <span class="o">!=</span> <span class="s2">""</span>
                <span class="n">codeStr</span> <span class="o">=</span> <span class="n">codeStr</span><span class="p">.</span><span class="nf">lines</span><span class="p">.</span><span class="nf">to_a</span><span class="p">[</span><span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">join</span>  <span class="c1"># 첫줄 제거</span>
              <span class="k">end</span>
            <span class="k">end</span>
          <span class="k">end</span>
        <span class="k">end</span>

        <span class="n">code</span> <span class="o">=</span> <span class="n">pygmentize</span><span class="p">(</span><span class="n">codeStr</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span>
        <span class="n">code_attr</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">isSapn</span>
          <span class="k">if</span> <span class="n">lang</span>
            <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"highlight notranslate"</span>
            <span class="k">if</span> <span class="n">code_attr</span><span class="p">.</span><span class="nf">has_key?</span><span class="p">(</span><span class="s1">'class'</span><span class="p">)</span>
              <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">" language-</span><span class="si">#{</span><span class="n">lang</span><span class="si">}</span><span class="s2">"</span>
            <span class="k">else</span>
              <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"language-</span><span class="si">#{</span><span class="n">lang</span><span class="si">}</span><span class="s2">"</span>
            <span class="k">end</span>
          <span class="k">end</span>
        <span class="k">else</span>
          <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"language-</span><span class="si">#{</span><span class="n">lang</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="n">lang</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="kp">nil</span>
          <span class="n">code</span> <span class="o">=</span> <span class="n">escape_html</span><span class="p">(</span><span class="n">codeStr</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">!=</span> <span class="kp">nil</span>
            <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">" nmcode"</span>
          <span class="k">else</span>
            <span class="n">code_attr</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"nmcode"</span>
          <span class="k">end</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">isSapn</span>
          <span class="s2">"&lt;code</span><span class="si">#{</span><span class="n">html_attributes</span><span class="p">(</span><span class="kp">attr</span><span class="p">)</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">#{</span><span class="n">code</span><span class="si">}</span><span class="s2">&lt;/code&gt;"</span>
        <span class="k">else</span>
          <span class="s2">"</span><span class="si">#{</span><span class="s1">' '</span><span class="o">*</span><span class="n">indent</span><span class="si">}</span><span class="s2">&lt;figure class='code'&gt;</span><span class="si">#{</span><span class="n">caption</span><span class="si">}</span><span class="s2">&lt;div class=</span><span class="se">\"</span><span class="s2">highlight notranslate</span><span class="se">\"</span><span class="s2">&gt;&lt;pre</span><span class="si">#{</span><span class="n">html_attributes</span><span class="p">(</span><span class="kp">attr</span><span class="p">)</span><span class="si">}</span><span class="s2">&gt;&lt;code</span><span class="si">#{</span><span class="n">html_attributes</span><span class="p">(</span><span class="n">code_attr</span><span class="p">)</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">#{</span><span class="n">code</span><span class="si">}</span><span class="s2">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;</span><span class="se">\n</span><span class="s2">"</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">pygmentize</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lang</span>
          <span class="no">Pygments</span><span class="p">.</span><span class="nf">highlight</span><span class="p">(</span><span class="n">code</span><span class="p">,</span>
            <span class="ss">:lexer</span> <span class="o">=&gt;</span> <span class="n">lang</span><span class="p">,</span>
<span class="c1">#            :options =&gt; { :startinline =&gt; true, :encoding =&gt; 'utf-8', :nowrap =&gt; true })</span>
            <span class="ss">:options</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:startinline</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:encoding</span> <span class="o">=&gt;</span> <span class="s1">'utf-8'</span><span class="p">,</span> <span class="ss">:linenos</span> <span class="o">=&gt;</span> <span class="s1">'table'</span> <span class="p">})</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># This class is the actual custom Jekyll converter.</span>
<span class="k">class</span> <span class="nc">Jekyll</span><span class="o">::</span><span class="no">Converters</span><span class="o">::</span><span class="no">Markdown</span><span class="o">::</span><span class="no">KramdownPygments</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="nb">require</span> <span class="s1">'kramdown'</span>
    <span class="vi">@config</span> <span class="o">=</span> <span class="n">config</span>
  <span class="k">rescue</span> <span class="no">LoadError</span>
    <span class="no">STDERR</span><span class="p">.</span><span class="nf">puts</span> <span class="s1">'You are missing a library required for Markdown. Please run:'</span>
    <span class="no">STDERR</span><span class="p">.</span><span class="nf">puts</span> <span class="s1">'  $ [sudo] gem install kramdown'</span>
    <span class="k">raise</span> <span class="no">FatalException</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"Missing dependency: kramdown"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="no">Kramdown</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="p">{</span>
        <span class="ss">:auto_ids</span>             <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'auto_ids'</span><span class="p">],</span>
        <span class="ss">:footnote_nr</span>          <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'footnote_nr'</span><span class="p">],</span>
        <span class="ss">:entity_output</span>        <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'entity_output'</span><span class="p">],</span>
        <span class="ss">:toc_levels</span>           <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'toc_levels'</span><span class="p">],</span>
        <span class="ss">:smart_quotes</span>         <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'smart_quotes'</span><span class="p">],</span>
        <span class="ss">:kramdown_default_lang</span> <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'default_lang'</span><span class="p">],</span>
        <span class="ss">:input</span>                <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'input'</span><span class="p">],</span>
        <span class="ss">:hard_wrap</span>            <span class="o">=&gt;</span> <span class="vi">@config</span><span class="p">[</span><span class="s1">'kramdown'</span><span class="p">][</span><span class="s1">'hard_wrap'</span><span class="p">]</span>
    <span class="p">}).</span><span class="nf">to_pygments_html</span>
    <span class="k">return</span> <span class="n">html</span><span class="p">;</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<p>보다 자세한 처리 결과를 확인하고 싶다면 이 블로그의 소스를 참고하기 바란다. <a href="https://github.com/asamaru7/blog">asamaru7/blog - Github</a></p>

						<!--
							{ % if post.excerpt.size > 32 % }
							{ { post.excerpt } }
							{ % else % }
							{ { post.content | strip_html | strip_newlines | truncate: 160 } }
							{ % endif % }
						-->
						</p>
						
						<footer>
							
                      <span class="word-keep pull-right">
                          <a href="https://blog.asamaru.net/2015/12/23/moving-from-octopress-to-jekyll/#post-comment"><span class="glyphicon glyphicon-comment"></span>&nbsp;Comment</a>
                          <a href="https://blog.asamaru.net/2015/12/23/moving-from-octopress-to-jekyll/#post-share"><span class="glyphicon glyphicon-heart"></span>&nbsp;Share</a>
                      </span>
						</footer>
					</div>
				</article>
				
			</section>

			<nav class="text-center">
				<ul class="pager">
					
					<li class="previous"><a href="/posts/64">&larr;&nbsp;이전글</a></li>
					
					<li><a href="/archives/">Blog Archives</a></li>
					
					<li class="next"><a href="/posts/62">다음글&nbsp;&rarr;</a></li>
					
				</ul>
			</nav>
		</div>
		<div class="adsense-bottom">
			<!-- adsense -->
			<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<!-- 블로그 하단 -->
			<ins class="adsbygoogle"
				 style="display:block"
				 data-ad-client="ca-pub-8163803188491150"
				 data-ad-slot="7841851420"
				 data-ad-format="auto"></ins>
			<script>
				(adsbygoogle = window.adsbygoogle || []).push({});
			</script>
			<!-- adsense -->
		</div>
	</div>
	<div class="content-navigation col-lg-3">
		<!-- adsense -->
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- 블로그 우측 -->
		<ins class="adsbygoogle"
			 style="display:block"
			 data-ad-client="ca-pub-8163803188491150"
			 data-ad-slot="1934918622"
			 data-ad-format="auto"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
		<!-- adsense -->
	</div>
</div>


		
	</div>

	<div class="page-scrollTop" data-toggle="tooltip" data-placement="top" title="Top">
		<a href="javascript:void(0);">
			<div class="arrow"></div>
			<div class="stick"></div>
		</a>
	</div>
</div>

<footer class="footnote footnote-tiffany">
	<div class="container">
		<a class="foot-item" href="mailto:asamaru@asamaru.net" target="_blank"><img src="/static/img/bottom-email.png" alt="Email"></a>
		<a class="foot-item" href="https://github.com/asamaru7" target="_blank"><img src="/static/img/bottom-github.png" alt="Github"></a>
		<a class="foot-item" href="https://blog.asamaru.net/atom.xml" target="_blank"><img src="/static/img/bottom-rss.png" alt="RSS"></a>
		&nbsp;
		<a href="https://blog.asamaru.net"><span class="word-keep">&copy; 유영재</span></a>
	</div>
</footer>


<div class="scriptHub">
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://blog.asamaru.net/static/js/script.js"></script>

	
	
</div>



</body>
</html>
